BookFor As screen:
    Fill: =Dashboard.Fill
    Height: =Max(App.Height, App.DesignHeight)
    OnVisible: =
    Width: =Max(App.Width, App.DesignWidth)

    lblMyAppointments_5 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =115
        Size: =32
        Text: ="Book for"
        Width: =640
        ZIndex: =3

    bgRounded_18 As htmlViewer:
        Height: =898
        HtmlText: |
            =If(varTheme="Dark",
            "<div style='border-radius:10%;height:870px;width:100%;background-color:#1D1F23'></div>",
            "<div style='border-radius:10%;height:870px;width:100%;background-color:#FCFCFC'></div>")
        Width: =610
        X: =15
        Y: =116
        ZIndex: =4

    Tabs_14 As Tabs:
        FontColor: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        IconColor: |-
            =ColorValue("#874EB5")
        Items: |-
            =Table(
                {
                    Name: "Go Home",
                    Icon: Icon.DetailList,
                    Page: Dashboard,        
                    Visible:true
                },
                {
                    Name: " My Bookings",
                    Icon: Icon.Person,
                    Page: MyAppts,
                    Visible:true
                },
                {
                    Name: "New Request",
                    Icon: Icon.Add,
                    Page: Schedule_Screen,
                    Visible:true
                },
                {
                    Name: "Manage Rooms",
                    Icon: Icon.ComputerDesktop,
                    Page: ManageDesks,
                    Visible:varAdmin
                }
            )
        Y: =1016
        ZIndex: =5

    grpHeader_11 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =6

        Image2_12 As image:
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =640
            ZIndex: =1

        Rectangle2_11 As rectangle:
            Fill: =RGBA(135, 78, 181, 0.65)
            Height: =150
            Width: =640
            ZIndex: =2

    Button1_11 As button:
        Fill: =RGBA(135, 78, 181, 1)
        Height: =61
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: =Reset(tbSearch);Navigate(ModifyTimeSlot,ScreenTransition.None)
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =21
        Text: ="CONFIRM"
        Width: =450
        X: =100
        Y: =galPeople.Y + galPeople.Height + 15
        ZIndex: =12

    grpConfirmCancel_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =13

        Rectangle3_9 As rectangle:
            Fill: =RGBA(116, 116, 116, 0.85)
            Height: =1136
            Visible: =varConfirmCancel
            Width: =640
            ZIndex: =7

        bgRounded_19 As htmlViewer:
            Height: =651
            HtmlText: |-
                ="<div style='border:1px gray;border-radius:10%;height:450px;width:100%;background-color:#FCFCFC'></div>"
            Visible: =varConfirmCancel
            Width: =610
            X: =14
            Y: =165
            ZIndex: =8

        Label1_4 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Height: =87
            Size: =24
            Text: ="Confirm Cancellation"
            Visible: =varConfirmCancel
            Width: =557
            X: =40
            Y: =234
            ZIndex: =9

        btnConfirmCancel_4 As button:
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
                =UpdateContext({varConfirmCancel:false})
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="NEVERMIND"
            Visible: =varConfirmCancel
            X: =141
            Y: =401
            ZIndex: =10

        btnConfirmDelete_4 As button:
            BorderThickness: =0
            Fill: =RGBA(184, 0, 0, 1)
            Height: =45
            HoverFill: =ColorFade(Self.Fill, -20%)
            OnSelect: |-
                =Remove(List_DeskReservations,varSelectedReservation);UpdateContext({varConfirmCancel:false})
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =14
            Text: ="CONFIRM"
            Visible: =varConfirmCancel
            X: =341
            Y: =401
            ZIndex: =11

    Arrow1_5 As arrow.backArrow:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =60
        OnSelect: |-
            =Reset(tbSearch);
            Set(selectedPerson,Blank());
            Back()
        Width: =60
        X: =22
        Y: =29
        ZIndex: =14

    "galPeople As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        '#CopilotOverlayLabel': ="Filtered"
        AccessibleLabel: ="list of people"
        Height: =611
        Items: |-
            =With(
                {
                    searchTxt: Lower(Trim(tbSearch.Text))
                },
                If(
                    IsBlank(searchTxt),
                    With(
                        {
                            base: Office365Users.SearchUser({ searchTerm: "", top: 6 })
                        },
                        SortByColumns(
                            AddColumns(
                                base,
                                Hines_MailNickname,
                                If(
                                    StartsWith(Lower(Coalesce(MailNickname, "")), "vhahin"),
                                    0,
                                    1
                                )
                            ),
                            "Hines_MailNickname",
                            SortOrder.Ascending,
                            "DisplayName",
                            SortOrder.Ascending
                        )
                    ),
                    With(
                        {
                            base: Office365Users.SearchUser({ searchTerm: tbSearch.Text, top: 25 })
                        },
                        With(
                            {
                                filtered:
                                    Filter(
                                        base,
                                        StartsWith(Lower(Surname & ", " & GivenName), searchTxt) ||
                                        StartsWith(Lower(GivenName & " " & Surname), searchTxt) ||
                                        StartsWith(Lower(Surname), searchTxt) ||
                                        StartsWith(Lower(GivenName), searchTxt) ||
                                        StartsWith(Lower(Mail), searchTxt) ||
                                        StartsWith(Lower(UserPrincipalName), searchTxt)
                                    )
                            },
                            SortByColumns(
                                AddColumns(
                                    filtered,
                                    Hines_MailNickname,
                                    If(
                                        StartsWith(Lower(Coalesce(MailNickname, "")), "vhahin"),
                                        0,
                                        1
                                    )
                                ),
                                "Hines_MailNickname",
                                SortOrder.Ascending,
                                "DisplayName",
                                SortOrder.Ascending
                            )
                        )
                    )
                )
            )
        Layout: =Layout.Vertical
        OnSelect: =Set(selectedPerson,ThisItem)
        TabIndex: =3
        TemplatePadding: =0
        TemplateSize: =Button2.Height + 2
        Width: =bgRounded_18.Width - 10
        X: =20
        Y: =290
        ZIndex: =16

        Separator1 As rectangle:
            AccessibleLabel: ="separator for list item"
            Fill: =RGBA(204, 204, 204, 1)
            Height: =2
            OnSelect: =Select(Parent)
            TabIndex: =7
            Width: =Button2.Width + 10
            X: =Button2.X - 5
            Y: =Button2.Y + Button2.Height -Self.Height
            ZIndex: =2

        urlEmployeeEmail As Link:
            Align: =""
            BasePaletteColor: =
            BorderColor: =
            DisplayMode: =DisplayMode.Edit
            Fill: =
            FontItalic: =true
            FontSize: =16
            FontUnderline: =true
            FontWeight: =FontWeight.Semibold
            Height: =lblEmployeeName.Height
            Text: =Upper(ThisItem.Mail)
            Width: =lblEmployeeName.Width
            X: =lblEmployeeName.X + 10
            Y: =lblEmployeeJobTitle.Y + lblEmployeeJobTitle.Height
            ZIndex: =3

        lblEmployeeJobTitle As label:
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =16
            TabIndex: =6
            Text: =Upper(ThisItem.JobTitle)
            VerticalAlign: =VerticalAlign.Top
            Width: =lblEmployeeName.Width
            X: =lblEmployeeName.X + 10
            Y: =lblEmployeeName.Y + lblEmployeeName.Height
            ZIndex: =4

        lblEmployeeName As label:
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =26
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =16
            TabIndex: =5
            Text: =ThisItem.DisplayName
            VerticalAlign: =VerticalAlign.Top
            Width: =bgRounded_18.X + bgRounded_18.Width - Parent.X - (Self.X * 2)
            X: =25
            Y: =5
            ZIndex: =5

        Button2 As button:
            AutoDisableOnSelect: =false
            BorderColor: |-
                =If(
                    Icon6.Visible,
                    Self.HoverBorderColor,
                    RGBA(255, 255, 255, 0)
                )
            BorderThickness: |-
                =If(
                    Icon6.Visible,
                    5,
                    0
                )
            Color: =RGBA(0, 0, 0, 1)
            Fill: |-
                =If(
                    Icon6.Visible,
                    Self.HoverFill,
                    RGBA(255, 255, 255, 0)
                )
            Height: =urlEmployeeEmail.Y + urlEmployeeEmail.Height + 5
            HoverBorderColor: =RGBA(56, 96, 178, 1)
            HoverColor: =RGBA(56, 96, 178, 0.75)
            HoverFill: =RGBA(56, 96, 178, 0.4)
            OnSelect: =Select(Parent)
            PressedBorderColor: =ColorFade(Self.HoverBorderColor, -20%)
            PressedColor: =ColorFade(Self.HoverColor, -20%)
            PressedFill: =ColorFade(Self.HoverFill, -20%)
            Size: =24
            Text: =
            Width: =Parent.Width - Parent.X - Self.X
            X: =lblEmployeeName.X - 5
            Y: =lblEmployeeName.Y
            ZIndex: =6

        Icon6 As icon.CheckBadge:
            AccessibleLabel: ="person chosen icon"
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
            Height: =30
            Icon: =Icon.CheckBadge
            OnSelect: =Select(Parent)
            TabIndex: =8
            Visible: |-
                =If(
                    !IsBlank(selectedPerson.Mail) && ThisItem.Mail = selectedPerson.Mail,
                        true,
                    IsBlank(selectedPerson.Mail),
                        false,
                    ThisItem.Mail = selectedPerson.Mail
                )
            Width: =30
            X: =Button2.X + Button2.Width - Self.Width - 25
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =7

    Container3 As groupContainer.manualLayoutContainer:
        Height: =lblAdd.Height + tbSearch.Height + Separator1_2.Height + 10
        Width: =galPeople.Width
        X: =galPeople.X
        Y: =galPeople.Y - Self.Height
        ZIndex: =20

        Separator1_2 As rectangle:
            BorderColor: =RGBA(0, 18, 107, 0.75)
            BorderThickness: =3
            Fill: =RGBA(204, 204, 204, 1)
            Height: =2
            OnSelect: =
            Width: =tbSearch.Width - 2
            X: =(Parent.Width - Self.Width) / 2
            Y: =tbSearch.Y + tbSearch.Height + Self.BorderThickness + 1
            ZIndex: =1

        tbSearch As text:
            AccessibleLabel: ="Enter a person's name to search for"
            BorderColor: =RGBA(179, 179, 179, 1)
            BorderThickness: =0
            Clear: =true
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 18, 107, 1))
            Default: |-
                =If(
                    IsBlank(selectedPerson),
                    User().Email,
                    selectedPerson.Mail
                )
                //Concatenate(selectedPerson.DisplayName, " (", selectedPerson.Mail, ")")
            Fill: |-
                =If(varTheme="Dark",ColorValue("#2A2B33"), Color.LightGray)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =60
            HintText: =" . . . Start typing an employee name or email address to search"
            HoverFill: =Self.Fill
            Italic: =true
            PaddingLeft: =7
            PressedBorderColor: =Self.BorderColor
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: |-
                =If(
                    IsBlank(selectedPerson.Mail),
                    12,
                    18
                )
            TabIndex: =2
            Underline: =//!IsBlank(selectedPerson.DisplayName)
            Width: =Parent.Width - 100
            X: =(Parent.Width - Self.Width) / 2
            Y: =lblAdd.Y + lblAdd.Height - 5
            ZIndex: =2

        Icon5 As icon.Cancel:
            AccessibleLabel: ="Clear out search"
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
            Height: =30
            HoverBorderColor: =RGBA(0, 18, 107, 1)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 18, 107, 0.75)
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(selectedPerson,Blank());
                Reset(tbSearch);
                tbSearch.Clear
            TabIndex: =9
            Visible: =//!IsBlank(tbSearch.Text)
            Width: =30
            X: =tbSearch.Width + 10
            Y: =Parent.Height - tbSearch.Height
            ZIndex: =3

        lblAdd As label:
            Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            Height: =60
            LineHeight: =1
            Size: =15
            TabIndex: =1
            Text: ="Which Provider/Clinical Staff will be treating these patients?"
            Width: =tbSearch.Width + tbSearch.X
            X: =20
            ZIndex: =4

