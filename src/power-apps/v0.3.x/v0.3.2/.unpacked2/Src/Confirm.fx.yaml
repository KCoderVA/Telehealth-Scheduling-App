Confirm As screen:
    Fill: =Dashboard.Fill
    Height: =Max(App.Height, App.DesignHeight)
    Width: =Max(App.Width, App.DesignWidth)

    lblLookGood As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Bold
        Height: =113
        Size: =32
        Text: ="Everything look good?"
        Width: =640
        ZIndex: =3

    bgRounded As htmlViewer:
        Height: =619
        HtmlText: |+
            =If(varTheme="Dark",
            "<div style='border-radius:10%;height:590px;width:100%;background-color:#1D1F23'></div>",
            "<div style='border-radius:10%;height:590px;width:100%;background-color:#FCFCFC'></div>")
            
        Width: =610
        X: =16
        Y: =113
        ZIndex: =4

    lblDate As label:
        Align: =Align.Center
        AutoHeight: =true
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: |-
            =//130
            If(
                Len(Self.Text) > 26,
                130,
                lblSelected_LocationName.Height
            )
        Size: =30
        Text: |-
            =//Text(startTime,DateTimeFormat.LongDate) & " - " & Char(10) &Text(endTime,DateTimeFormat.LongDate)
            If(
                IsBlank(var_fromScreen_ModifyTimeSlot) || var_fromScreen_ModifyTimeSlot = false,
                    If(
                        (DateDiff(selectedDate, selectedEndDate, TimeUnit.Days) < 2),
                        Text(startTime,DateTimeFormat.LongDate),
                        Text(startTime,DateTimeFormat.LongDate) & " - " & Char(10) &Text(endTime,DateTimeFormat.LongDate)
                    ),
                var_fromScreen_ModifyTimeSlot_When
            )
        Width: =560
        X: =41
        Y: =lblSelected_DateIntro.Y + lblSelected_DateIntro.Height
        ZIndex: =5

    lblTime As label:
        Align: =Align.Center
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =24
        Text: =Text(startTime,DateTimeFormat.ShortTime) & " to " &Text(endTime,DateTimeFormat.ShortTime)
        Visible: |-
            =//Text(startTime,DateTimeFormat.LongDate) & " - " & Char(10) &Text(endTime,DateTimeFormat.LongDate)
            If(
                IsBlank(var_fromScreen_ModifyTimeSlot) || var_fromScreen_ModifyTimeSlot = false,
                    true,
                    false
            )
        Width: =560
        X: =39
        Y: =452
        ZIndex: =6

    lblSelected_LocationName As label:
        Align: =Align.Center
        AutoHeight: =true
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =30
        Text: |-
            =If(
                IsBlank(var_fromScreen_ModifyTimeSlot) || var_fromScreen_ModifyTimeSlot = false,
                    Concat(selectedDesks, Title, ", "),
                Concatenate(varSelectedSchedSlot.CBOC_Name_text, " CBOC - Room #", varSelectedSchedSlot.Room_number)
            )
        Width: =560
        X: =41
        Y: =lblScreenIntro.Y + lblScreenIntro.Height + 5
        ZIndex: =7

    toolbar_tabs As Tabs:
        FontColor: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        IconColor: |-
            =ColorValue("#874EB5")
        Items: |-
            =Table(
                {
                    Name: "Go Home",
                    Icon: Icon.DetailList,
                    Page: Dashboard,        
                    Visible:true
                },
                {
                    Name: " My Bookings",
                    Icon: Icon.Person,
                    Page: MyAppts,
                    Visible:true
                },
                {
                    Name: "New Request",
                    Icon: Icon.Add,
                    Page: Schedule_Screen,
                    Visible:true
                },
                {
                    Name: "Manage Rooms",
                    Icon: Icon.ComputerDesktop,
                    Page: ManageDesks,
                    Visible:varAdmin
                }
            )
        Visible: =false
        Y: =1016
        ZIndex: =8

    lblScreenIntro As label:
        Align: =Align.Center
        AutoHeight: =true
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        Height: =118
        Italic: =true
        Size: =18
        Text: |-
            ="Please review reservation details before submiting your request to the Telehealth Team for approval:"
        Width: =560
        X: =41
        Y: =bgRounded.Y + 10
        ZIndex: =9

    btnLooksGood As button:
        Fill: =RGBA(135, 78, 181, 1)
        Height: =61
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: |-
            =ForAll(
                col_SlotsToBeModified,
                Patch(
                    App_ReservationLog,
                    Defaults(App_ReservationLog),
                    {
                        Title: ThisRecord.Title,
                        CBOC_Name_text: ThisRecord.CBOC_Name_text,
                        Room_number: Value(ThisRecord.Room_number),
                        Room_Name_text: Concatenate(ThisRecord.CBOC_Name_text, ThisRecord.Room_number),
                        Room_Alias_number: Value(ThisRecord.Room_Alias_number),
                        Room_Extension_number: Value(ThisRecord.Room_Extension_number),
                        Room_IPaddress_text: ThisRecord.Room_IPaddress_text,
                        Modified_Type: "Reservation Submitted",
                        Modified_Status_DateTime: Now(),
                        //Modified_Status_Text: "",
                        Modified_Submitted_DateTime: Text(Now(), "mm/d/yyyy h:mm:ss AM/PM"),
                        Modified_SubmitterEmail_text: currentUser.Email,
                        Modified_SubmitterComment_text: If(varDoubleBook_Attestation = "I aknowledge", Concatenate("This reservation overbooks ", CountRows(col_SlotsToBeModified), " other time slots"), Blank()),
                        Modified_Approval_DateTime: Blank(),
                        Modified_ApproverEmail_text: Blank(),
                        Modified_Approval_Comments: Blank(),
                        Expiration_Start_DateTime: If("Do not repeat this reservation, it is for one single occurance only" in varRecurrance, Date(Year(varTargetExpiration_datetime), Month(varTargetExpiration_datetime), Day(varTargetExpiration_datetime)), "Repeat this reservation every week on the same day and time indefinately" in varRecurrance, Blank()),
                        Expiration_Stop_DateTime: If("Do not repeat this reservation, it is for one single occurance only" in varRecurrance, varTargetExpiration_datetime, "Repeat this reservation every week on the same day and time indefinately" in varRecurrance, Blank()),
                        TimeSlot_Start_text: ThisRecord.TimeSlot_Start_text,
                        TimeSlot_Start_number: Value(ThisRecord.TimeSlot_Start_number),
                        TimeSlot_text: ThisRecord.TimeSlot_text,
                        Day_Monday_text:    If(varSelectedSched_days="Mondays", varClinicalFreeText,    ThisRecord.Day_Monday_text),
                        Day_Tuesday_text:   If(varSelectedSched_days="Tuesdays", varClinicalFreeText,   ThisRecord.Day_Tuesday_text),
                        Day_Wednesday_text: If(varSelectedSched_days="Wednesdays", varClinicalFreeText, ThisRecord.Day_Wednesday_text),
                        Day_Thursday_text:  If(varSelectedSched_days="Thursdays", varClinicalFreeText,  ThisRecord.Day_Thursday_text),
                        Day_Friday_text:    If(varSelectedSched_days="Fridays", varClinicalFreeText,    ThisRecord.Day_Friday_text),
                        TCT_Name_text: ThisRecord.TCT_Name_text,
                        TCT_Email_text: ThisRecord.TCT_Email_text,
                        TCT_Phone_number: Value(ThisRecord.TCT_Phone_number),
                        TCT_Cell_text: ThisRecord.TCT_Cell_text,
                        TCT_Cell_number: Value(ThisRecord.TCT_Cell_number),
                        CNM_Name_text: ThisRecord.CNM_Name_text,
                        CNM_Email_text: ThisRecord.CNM_Email_text,
                        CNM_Phone_number: Value(ThisRecord.CNM_Phone_number),
                        CNM_Cell_text: ThisRecord.CNM_Cell_text,
                        CNM_Cell_number: Value(ThisRecord.CNM_Cell_number),
                        FTC_Name_text: ThisRecord.FTC_Name_text,
                        FTC_Email_text: ThisRecord.FTC_Email_text,
                        FTC_Phone_number: Value(ThisRecord.FTC_Phone_number),
                        FTC_Cell_text2: ThisRecord.FTC_Cell_text,
                        FTC_Cell_number: Value(ThisRecord.FTC_Cell_number),
                        selectedClinicalStaff_email: selectedPerson.Mail,
                        Modified_DayOfWeek: Replace(varSelectedSched_days, (Len(varSelectedSched_days)), 1, ""),
                        Modified_ClinicLocationName: varClinicalFreeText,
                        Modified_Submitted_CombiTable_RowNumber: varSelectedSched_ID
                    }
                )
            );
            
            
            /*ForAll(
                col_SlotsToBeModified,
                Patch(
                    App_ReservationLog,
                    Defaults(App_ReservationLog),
                    {
                        // ===== Required / Core =====
                        Title: ThisRecord.Title,
                        // ===== Location / Room Meta =====
                        CBOC_Name_text: ThisRecord.CBOC_Name_text,                 // Building (string)
                        Room_number: Value(ThisRecord.Room_number),   // Number
                        Room_Name_text: Concatenate(ThisRecord.CBOC_Name_text, ThisRecord.Room_number),             // Text (if you store one)
                        Room_Alias_number: Value(ThisRecord.Room_Alias_number),
                        Room_Extension_number: Value(ThisRecord.Room_Extension_number),
                        Room_IPaddress_text: ThisRecord.Room_IPaddress_text,
                        // ===== Modification / Workflow Status =====
                        Modified_Type: "Reservation Submitted",             // e.g. "UserSubmission", "Out-Of-Service"
                        Modified_Status_DateTime: Now(),
                        Modified_Status_Text: varSelectedSched_days,
                        Modified_Submitted_DateTime: Now(),
                        Modified_SubmitterEmail_text: selectedPerson.Mail,
                        Modified_SubmitterComment_text: varClinicalFreeText,
                        Modified_Approval_DateTime: Blank(),          // Use Blank() until approved
                        Modified_ApproverEmail_text: Blank(),            // Blank() if none
                        Modified_Approval_Comments: Blank(),
                        // ===== Expiration (if you apply temporary reservations / OOS windows) =====
                        Expiration_Start_DateTime: Blank(),
                        Expiration_Stop_DateTime: Blank(),
                        // ===== Time Slot Core (Numbers & Text) =====
                        TimeSlot_Start_time: Value(ThisRecord.TimeSlot_Start_time),       // Pure number (e.g., minutes index) if you track it
                        TimeSlot_End_time: Value(ThisRecord.TimeSlot_End_time),
                        TimeSlot_Start_text: ThisRecord.TimeSlot_Start_text, // From your existing variable list
                        TimeSlot_Start_number: Value(ThisRecord.TimeSlot_Start_number),     // If distinct from TimeSlot_Start_time
                        TimeSlot_text: ThisRecord.TimeSlot_text,
                        // ===== Weekday Occupancy Fields (blank = vacant) =====
                        //If(
                        //    varSelectedSched_days = "Mondays",
                                Day_Monday_text:    ThisRecord.Day_Monday_text,      
                        //    varSelectedSched_days = "Tuesdays",
                                Day_Tuesday_text:   ThisRecord.Day_Tuesday_text,
                        //    varSelectedSched_days = "Wednesdays",
                                Day_Wednesday_text: ThisRecord.Day_Wednesday_text,
                        //    varSelectedSched_days = "Thursdays",
                                Day_Thursday_text:  ThisRecord.Day_Thursday_text,
                        //    varSelectedSched_days = "Fridays",
                                Day_Friday_text:    ThisRecord.Day_Friday_text,
                        //),               
                        // ===== TCT (Telehealth Clinical Technician) Contact =====
                        TCT_Name_text: ThisRecord.TCT_Name_text,
                        TCT_Email_text: ThisRecord.TCT_Email_text,
                        TCT_Phone_number: Value(ThisRecord.TCT_Phone_number),
                        TCT_Cell_text: ThisRecord.TCT_Cell_text,             // If you store formatted string
                        TCT_Cell_number: Value(ThisRecord.TCT_Cell_number),
                        // ===== CNM (Clinic Nurse Manager) Contact =====
                        CNM_Name_text: ThisRecord.CNM_Name_text,
                        CNM_Email_text: ThisRecord.CNM_Email_text,
                        CNM_Phone_number: Value(ThisRecord.CNM_Phone_number),
                        CNM_Cell_text: ThisRecord.CNM_Cell_text,
                        CNM_Cell_number: Value(ThisRecord.CNM_Cell_number),
                        // ===== FTC (Facility Telehealth Coordinator) Contact =====
                        FTC_Name_text: ThisRecord.FTC_Name_text,
                        FTC_Email_text: ThisRecord.FTC_Email_text,               // (Note: column name uses lowercase 'email')
                        FTC_Phone_number: Value(ThisRecord.FTC_Phone_number),
                        FTC_Cell_text2: ThisRecord.FTC_Cell_text2,           // Column name as shown in screenshot
                        FTC_Cell_number: Value(ThisRecord.FTC_Cell_number)
                    }
                )
            );
            */
            
            
            Concurrent(
                Reset(ddTimeTo),
                Reset(ddTimeFrom),
                Reset(Calendar_1),
                Clear(selectedDesks),
                Set(selectedDate,Blank()),
                Set(startTime, Today()),
                Set(endTime,Today()),
                Set(selectedPerson, Blank())
            );
            
            Navigate(Success)
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =21
        Text: ="LOOKS GOOD!"
        Width: =450
        X: =96
        Y: =756
        ZIndex: =10

    btnMakeChanges As button:
        Fill: =RGBA(116, 116, 116, 1)
        Height: =61
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: =Back()
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =21
        Text: ="MAKE CHANGES"
        Width: =450
        X: =96
        Y: =853
        ZIndex: =11

    lblSelected_PersonIntro As label:
        Align: =Align.Center
        AutoHeight: =true
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        Height: =70
        Italic: =true
        Size: =20
        Text: ="on behalf of clinical team member"
        Width: =560
        X: =41
        Y: =lblDate.Y + lblDate.Height
        ZIndex: =12

    "'lblSelected_selectedPerson.DisplayName' As label":
        Align: =Align.Center
        AutoHeight: =true
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =30
        Text: |-
            =If(
                IsBlank(selectedPerson) || selectedPerson.DisplayName = "   . . .   enter text here",
                    "ERROR: No Clinic Selected",
                !IsBlank(varClinicalFreeText) || varClinicalFreeText <> "   . . .   enter text here",
                    selectedPerson.DisplayName
            )
        Width: =560
        X: =41
        Y: =lblSelected_PersonIntro.Y + lblSelected_PersonIntro.Height
        ZIndex: =13

    lblSelected_from As label:
        Align: =Align.Center
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        Font: =Font.'Segoe UI'
        Height: =70
        Size: =24
        Text: ="from"
        Visible: |-
            =false
            //Text(startTime,DateTimeFormat.LongDate) & " - " & Char(10) &Text(endTime,DateTimeFormat.LongDate)
            /*
            If(
                IsBlank(var_fromScreen_ModifyTimeSlot) || var_fromScreen_ModifyTimeSlot = false,
                    true,
                    false
            )
            */
        Width: =560
        X: =41
        Y: =402
        ZIndex: =14

    lblSelected_DateIntro As label:
        Align: =Align.Center
        AutoHeight: =true
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =70
        Italic: =true
        Size: =20
        Text: ="should be reserved on"
        Width: =560
        X: =39
        Y: =lblSelected_LocationName.Y + lblSelected_LocationName.Height
        ZIndex: =15

    grpHeader_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =15

        Image2_4 As image:
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =640
            ZIndex: =1

        Rectangle2_2 As rectangle:
            Fill: =RGBA(135, 78, 181, 0.65)
            Height: =150
            Width: =640
            ZIndex: =2

    lblSelected_ClinicIntro As label:
        Align: =Align.Center
        AutoHeight: =true
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =70
        Italic: =true
        Size: =20
        Text: |-
            ="as a part of the clinic/specialty team:"
        Width: =560
        X: =41
        Y: ='lblSelected_selectedPerson.DisplayName'.Y + 'lblSelected_selectedPerson.DisplayName'.Height
        ZIndex: =16

    lblSelected_varClinicalFreeText As label:
        Align: =Align.Center
        AutoHeight: =true
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =70
        Size: =30
        Text: |-
            =If(
                IsBlank(varClinicalFreeText) || varClinicalFreeText = "   . . .   enter text here",
                    "ERROR: No Clinic Selected",
                !IsBlank(varClinicalFreeText) || varClinicalFreeText <> "   . . .   enter text here",
                    varClinicalFreeText
            )
        Width: =560
        X: =41
        Y: =lblSelected_ClinicIntro.Y + lblSelected_ClinicIntro.Height
        ZIndex: =17

    TextCanvas4 As Text:
        BorderColor: =
        DisplayMode: =DisplayMode.Edit
        Fill: =
        FontColor: =
        Height: =52
        Text: =
        Width: =507
        X: =80
        Y: =623
        ZIndex: =18

    Tabs_20 As Tabs_1:
        ChildTabPriority: =true
        ContentLanguage: =""
        EnableChildFocus: =true
        IconColor: |-
            =Color.DarkBlue
            //ColorValue("#2771C2")
        Items: |-
            =Table(
                {
                    Name: "Home",
                    Icon: Icon.Home,
                    Page: Dashboard, //App.ActiveScreen,
                    Visible:true
                },
                {
                    Name: "Submissions",
                    Icon: Icon.DetailList,
                    Page: MyAppts, //App.ActiveScreen,
                    Visible:true
                },
                 {
                    Name: "Edit Rooms",
                    Icon: Icon.Settings,
                    Page: ManageDesks, //App.ActiveScreen,
                    Visible:true
                },
                {
                    Name: "Create New",
                    Icon: Icon.AddToCalendar,
                    Page: Schedule_Screen, //App.ActiveScreen,
                    Visible:true
                }
            )
        Visible: =false
        X: =Tabs_12.X
        Y: =1016
        ZIndex: =19

