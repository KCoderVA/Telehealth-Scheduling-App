"Schedule_Screen As screen.'printableLayout_A4Landscape_ver1.0'":
    Fill: =RGBA(180, 214, 250, 1)
    Height: =794
    OnHidden: |-
        =If(
            varRedirectedSchedScreen = false,
                Concurrent(
                    ClearCollect(col_CombiTable, TelehealthMasterSched_CombiTable),
                    Set(varSelectedSched_time, Blank()),
                    Set(varBuilding, Blank()),
                    Set(varRoomNumberSelected, Blank()),
                    Set(varRoomNumberSelectionText, Blank()),
                    Reset(dropdown_filterBLDG),
                    Reset(dropdown_filterROOM)
                ),
            varRedirectedSchedScreen = true,
                ""
        )
    OnVisible: |-
        =ClearCollect(col_SlotsToBeModified, Blank());
        Set(varSelectedDayOfWeek, Blank());
        Set(varTargetExpiration_datetime, Blank());
        Set(varSelectedSchedSlot, Blank());
        Set(varSelectedSchedSlot_secondary, Blank());
        Set(varSelectedSchedSlot_secondarySlot, Blank());
        Set(varSelectedSchedSlot_tertiary, Blank());
        Set(varSelectedSchedSlot_tertiarySlot, Blank());
        Set(varSelectedSched_days, Blank());
        Set(varSelectedSched_Availibility, Blank());
        Set(varSelectedSched_time, Blank());
        Set(varSelectedSchedSlot_startTime_text, Blank());
        Set(varSelectedSchedSlot_endTime_text, Blank());
        Set(varSelectedSchedSlot_endTime_text, Blank());
        Set(varSelectedSched_duration, Blank());
        Set(var_fromScreen_ModifyTimeSlot_When, Blank());
        Set(varSelectedSchedSlot_endTime_text, Blank());
        Set(varSelectedSched_ID, Blank());
        Set(varSelectedSched_CBOCName, Blank());
        Set(var_fromScreen_ModifyTimeSlot, Blank());
        Set(varSelectedSchedSlot_startTime_text, Blank());
        If(
            IsBlank(varSchedScreenInstructions_visible),
            Set(varSchedScreenInstructions_visible, true)
        );
        If(
            varRedirectedSchedScreen = false,
                Concurrent(
                    ClearCollect(col_CombiTable, TelehealthMasterSched_CombiTable),
                    Set(varSelectedSched_time, Blank()),
                    Set(varBuilding, Blank()),
                    Set(varRoomNumberSelected, Blank()),
                    Set(varRoomNumberSelectionText, Blank()),
                    Reset(dropdown_filterBLDG),
                    Reset(dropdown_filterROOM)
                ),
            varRedirectedSchedScreen = true,
                ""
        );
        ClearCollect(
            col_TelehealthClinics,
            [
                {VistA_Clinic_Name: "AUR CVT CHAPLAIN PAT"},
                {VistA_Clinic_Name: "AUR CVT CHAPLAIN PRO"},
                {VistA_Clinic_Name: "AUR CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "AUR CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "AUR CVT MH INTAKE REVIEW PAT"},
                {VistA_Clinic_Name: "AUR CVT MH INTAKE REVIEW PRO"},
                {VistA_Clinic_Name: "AUR CVT MH TSP PAT"},
                {VistA_Clinic_Name: "AUR CVT MH TSP PRO"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 1 PAT"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 1 PRO"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 16 PAT"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 16 PRO"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 29 PAT"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 29 PRO"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 43 PAT"},
                {VistA_Clinic_Name: "AUR CVT MHC PHYSN 43 PRO"},
                {VistA_Clinic_Name: "AUR CVT MHC PSYCL 30 PAT"},
                {VistA_Clinic_Name: "AUR CVT MHC PSYCL 30 PRO"},
                {VistA_Clinic_Name: "AUR CVT SLC GMS PAT 2"},
                {VistA_Clinic_Name: "AUR CVT SPEECH PAT"},
                {VistA_Clinic_Name: "AUR CVT SPEECH PRO"},
                {VistA_Clinic_Name: "JOL CVT GI TELEPREP PAT"},
                {VistA_Clinic_Name: "JOL CVT GI TELEPREP PRO"},
                {VistA_Clinic_Name: "JOL CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "JOL CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHARM D 2 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHARM D 2 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 12 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 12 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 13 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 13 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 24 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 24 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 25 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 25 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 7 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC PHYSN 7 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC SW 127 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC SW 127 PRO"},
                {VistA_Clinic_Name: "JOL CVT MHC SW 32 PAT"},
                {VistA_Clinic_Name: "JOL CVT MHC SW 32 PRO"},
                {VistA_Clinic_Name: "JOL CVT PM&R AMPUTATION PAT"},
                {VistA_Clinic_Name: "JOL CVT PM&R AMPUTATION PRO"},
                {VistA_Clinic_Name: "JOL CVT PSYCL 5 PAT"},
                {VistA_Clinic_Name: "JOL CVT PSYCL 5 PRO"},
                {VistA_Clinic_Name: "JOL CVT SLC GMS PAT"},
                {VistA_Clinic_Name: "JOL CVT SPEECH PAT"},
                {VistA_Clinic_Name: "JOL CVT SPEECH PRO"},
                {VistA_Clinic_Name: "JOL CVT TSP PAT"},
                {VistA_Clinic_Name: "JOL CVT TSP PRO"},
                {VistA_Clinic_Name: "HE CVT CHAPLAIN PAT"},
                {VistA_Clinic_Name: "HE CVT CHAPLAIN PRO"},
                {VistA_Clinic_Name: "HE CVT GI LIVER TRANSPL PAT"},
                {VistA_Clinic_Name: "HE CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "HE CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "HE CVT MH INTAKE REVIEW PAT"},
                {VistA_Clinic_Name: "HE CVT MH INTAKE REVIEW PRO"},
                {VistA_Clinic_Name: "HE CVT MH TSP PAT"},
                {VistA_Clinic_Name: "HE CVT MH TSP PRO"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 27 PAT"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 27 PRO"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 32 PAT"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 32 PRO"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 39 PAT"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 39 PRO"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 45 PAT"},
                {VistA_Clinic_Name: "HE CVT MHC PHYSN 45 PRO"},
                {VistA_Clinic_Name: "HE CVT MHC SW 50 PAT"},
                {VistA_Clinic_Name: "HE CVT MHC SW 50 PRO"},
                {VistA_Clinic_Name: "HE CVT SLC GMS PAT"},
                {VistA_Clinic_Name: "HE CVT SPEECH PAT"},
                {VistA_Clinic_Name: "HE CVT SPEECH PRO"},
                {VistA_Clinic_Name: "KAN CVT CHAPLAIN PAT"},
                {VistA_Clinic_Name: "KAN CVT CHAPLAIN PRO"},
                {VistA_Clinic_Name: "KAN CVT GI LIVER TRANSPLT PAT"},
                {VistA_Clinic_Name: "KAN CVT GI MD PAT"},
                {VistA_Clinic_Name: "KAN CVT GI MD PRO"},
                {VistA_Clinic_Name: "KAN CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "KAN CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "KAN CVT MH INTAKE REV PAT"},
                {VistA_Clinic_Name: "KAN CVT MH INTAKE REV PRO"},
                {VistA_Clinic_Name: "KAN CVT MHC PHARM D 1 PAT"},
                {VistA_Clinic_Name: "KAN CVT MHC PHARM D 1 PRO"},
                {VistA_Clinic_Name: "KAN CVT MHC PHYSN 19 PAT"},
                {VistA_Clinic_Name: "KAN CVT MHC PHYSN 19 PRO"},
                {VistA_Clinic_Name: "KAN CVT MHC PSYCL 37 PAT"},
                {VistA_Clinic_Name: "KAN CVT MHC PSYCL 37 PRO"},
                {VistA_Clinic_Name: "KAN CVT PACT 1 MD PAT"},
                {VistA_Clinic_Name: "KAN CVT PACT 1 MD PRO"},
                {VistA_Clinic_Name: "KAN CVT PM&R AMPUTATION PAT"},
                {VistA_Clinic_Name: "KAN CVT PM&R AMPUTATION PRO"},
                {VistA_Clinic_Name: "KAN CVT SLC GMS PAT 2"},
                {VistA_Clinic_Name: "KAN CVT SPEECH PAT"},
                {VistA_Clinic_Name: "KAN CVT SPEECH PRO"},
                {VistA_Clinic_Name: "KAN CVT TSP PAT"},
                {VistA_Clinic_Name: "KAN CVT TSP PRO"},
                {VistA_Clinic_Name: "LAS CVT AUDIO EVAL & FIT PAT"},
                {VistA_Clinic_Name: "LAS CVT AUDIO EVAL & FIT PRO"},
                {VistA_Clinic_Name: "LAS CVT CHAPLAIN PAT"},
                {VistA_Clinic_Name: "LAS CVT CHAPLAIN PRO"},
                {VistA_Clinic_Name: "LAS CVT GI MD PAT"},
                {VistA_Clinic_Name: "LAS CVT GI MD PRO"},
                {VistA_Clinic_Name: "LAS CVT HA FOLLOW UP PAT"},
                {VistA_Clinic_Name: "LAS CVT HA FOLLOW UP PRO"},
                {VistA_Clinic_Name: "LAS CVT HA REPAIR PAT"},
                {VistA_Clinic_Name: "LAS CVT HA REPAIR PRO"},
                {VistA_Clinic_Name: "LAS CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "LAS CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "LAS CVT MH INTAKE REV PAT"},
                {VistA_Clinic_Name: "LAS CVT MH INTAKE REV PRO"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 38 PAT"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 38 PRO"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 42 PAT"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 42 PRO"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 8 PAT"},
                {VistA_Clinic_Name: "LAS CVT MHC PHYSN 8 PRO"},
                {VistA_Clinic_Name: "LAS CVT PM&R AMPUTATION PAT"},
                {VistA_Clinic_Name: "LAS CVT PM&R AMPUTATION PRO"},
                {VistA_Clinic_Name: "LAS CVT SLC GMS PAT 2"},
                {VistA_Clinic_Name: "LAS CVT SPEECH PAT"},
                {VistA_Clinic_Name: "LAS CVT SPEECH PRO"},
                {VistA_Clinic_Name: "LAS CVT TSP PAT"},
                {VistA_Clinic_Name: "LAS CVT TSP PRO"},
                {VistA_Clinic_Name: "OL CVT CHAPLAIN PAT"},
                {VistA_Clinic_Name: "OL CVT CHAPLAIN PRO"},
                {VistA_Clinic_Name: "OL CVT GEC PALLIATIVE NP PAT"},
                {VistA_Clinic_Name: "OL CVT GEC PALLIATIVE NP PRO"},
                {VistA_Clinic_Name: "OL CVT GEC PALLIATIVE PAT"},
                {VistA_Clinic_Name: "OL CVT GEC PALLIATIVE PRO"},
                {VistA_Clinic_Name: "OL CVT GI TELEPREP PAT"},
                {VistA_Clinic_Name: "OL CVT GI TELEPREP PRO"},
                {VistA_Clinic_Name: "OL CVT LIVER TRANS PHARM D PAT"},
                {VistA_Clinic_Name: "OL CVT LIVER TRANSPLT PAT"},
                {VistA_Clinic_Name: "OL CVT MH INTAKE PAT"},
                {VistA_Clinic_Name: "OL CVT MH INTAKE PRO"},
                {VistA_Clinic_Name: "OL CVT MH INTAKE REV PAT"},
                {VistA_Clinic_Name: "OL CVT MH INTAKE REV PRO"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 15 PAT"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 15 PRO"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 37 PAT"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 37 PRO"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 41 PAT"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 41 PRO"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 44 PAT"},
                {VistA_Clinic_Name: "OL CVT MHC PHYSN 44 PRO"},
                {VistA_Clinic_Name: "OL CVT SLC GMS PAT 2"},
                {VistA_Clinic_Name: "OL CVT SPEECH PAT"},
                {VistA_Clinic_Name: "OL CVT SPEECH PRO"},
                {VistA_Clinic_Name: "OL CVT TSP PAT"},
                {VistA_Clinic_Name: "OL CVT TSP PRO"}
            ]
        );
        
        Set(varVacantBlocksQTY, Blank());
        With(
            {
                // Raw control / variable inputs
                selBldgRaw: dropdown_filterBLDG.Selected.Value,
                selRoomRaw: dropdown_filterROOM.Selected.Value
            },
            With(
                {
                    // Normalize selections (Blank() = no filter)
                    selBldg:
                        If(
                            IsBlank(selBldgRaw) || selBldgRaw = "All",
                            Blank(),
                            selBldgRaw
                        ),
                    selRoom:
                        If(
                            IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                            Blank(),
                            selRoomRaw
                        )
                },
                With(
                    {
                        buildingRows:
                            If(
                                IsBlank(selBldg),
                                col_CombiTable,
                                Filter(
                                    col_CombiTable,
                                    Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                )
                            )
                    },
                    With(
                        {
                            roomRows:
                                If(
                                    IsBlank(selRoom),
                                    buildingRows,
                                    Filter(
                                        buildingRows,
                                        Coalesce(Room_number, Room_number) = selRoom
                                    )
                                )
                        },
                        With(
                            {
                                vacantBlocks:
                                    Sum(
                                        roomRows,
                                        If(
                                            Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                            0,
                                            If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                            If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                            If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                            If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                            If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                        )
                                    )
                            },
                            With(
                                {
                                    colorNumber: "#b80000",   // color for the numeric count
                                    colorEntity: "#004b87"    // color for building / room text
                                },
                                If(
                                    IsBlank(selBldg),
                                    // CASE 1: No building selected (or "All")
                                       Set(varVacantBlocksQTY, vacantBlocks),
                                       //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                       //Text(vacantBlocks) &
                                       //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
        
                                    If(
                                        IsBlank(selRoom),
                                        // CASE 2: Building only
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                           //selBldg &
                                           //" CBOC</u></span>.</p>",
        
                                        // CASE 3: Building + Room
                                           Set(varVacantBlocksQTY, vacantBlocks)
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                           //Text(selRoom) &
                                           //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                           //selBldg &
                                           //" CBOC</u></span>.</p>"
                                    )
                                )
                            )
                        )
                    )
                )
            )
        );
    Width: =1123

    DEPRECIATED_containerSchedule_Multiple As groupContainer.manualLayoutContainer:
        Height: |-
            =If(
                Self.Visible = true,
                (Parent.Height - Self.Y),
                0
            )
        Visible: =false
        Width: =Parent.Width
        Y: =icon_Home.Y + icon_Home.Height + 10
        ZIndex: =1

        Container1_2 As groupContainer.manualLayoutContainer:
            Height: =Parent.Height
            maximumHeight: =11360
            maximumWidth: =640
            Width: =Parent.Width - (Self.X * 2)
            ZIndex: =1

            Table3 As Table.pcfdataset:
                BasePaletteColor: =
                DateOnlyFormat: ='PowerAppsOneGrid.DateOnlyFormat'.ShortDate
                DateTimeFormat: ='PowerAppsOneGrid.DateTimeFormat'.ShortDateTime
                DisplayMode: =DisplayMode.Edit
                Height: =719
                Items: |-
                    =//col_CombiTable
                    If(
                        !IsBlank(dropdown_filterBLDG.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                            )),
                        Blank()
                    )
                onCellValueChange: =false
                onFilter: =false
                onNavigate: =false
                onRowSelect: =false
                onSave: =false
                OnSelect: =false
                ShowColumnHeaders: ="no"
                ShowFooter: ="no"
                Visible: =false
                Width: =993
                X: =130
                Y: =0
                ZIndex: =1

                field_221 As PowerAppsOneGridTemplate_dataField.textualColumn:
                    FieldDisplayName: ="field_22"
                    FieldName: ="field_22"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    Width: =0
                    ZIndex: =35

                field_231 As PowerAppsOneGridTemplate_dataField.textualColumn:
                    FieldDisplayName: ="field_23"
                    FieldName: ="field_23"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =2
                    Width: =0
                    ZIndex: =36

                field_241 As PowerAppsOneGridTemplate_dataField.textualColumn:
                    FieldDisplayName: ="field_24"
                    FieldName: ="field_24"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =3
                    Width: =0
                    ZIndex: =37

                field_251 As PowerAppsOneGridTemplate_dataField.textualColumn:
                    FieldDisplayName: ="field_25"
                    FieldName: ="field_25"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =4
                    Width: =0
                    ZIndex: =38

                field_261 As PowerAppsOneGridTemplate_dataField.textualColumn:
                    FieldDisplayName: ="field_26"
                    FieldName: ="field_26"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =5
                    Width: =0
                    ZIndex: =39

            Header_Timeslot_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Timeslot:"
                Width: =Gallery_Timeslot.Width
                X: =Gallery_Timeslot.X
                ZIndex: =2

            Header_Monday_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Monday:"
                Width: =Gallery_Monday.Width
                X: =Gallery_Monday.X
                ZIndex: =3

            Header_Tuesday_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Tuesday:"
                Width: =Gallery_Tuesday.Width
                X: =Gallery_Tuesday.X
                ZIndex: =4

            Header_Wednesday_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Wednesday:"
                Width: =Gallery_Wednesday.Width
                X: =Gallery_Wednesday.X
                ZIndex: =5

            Header_Thursday_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Thursday:"
                Width: =Gallery_Thursday.Width
                X: =Gallery_Thursday.X
                ZIndex: =6

            Header_Friday_2 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(56, 96, 178, 1)
                FontWeight: =FontWeight.Semibold
                Height: =35
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                Size: =16
                Text: |-
                    ="Friday:"
                Width: =Gallery_Friday.Width
                X: =Gallery_Friday.X
                ZIndex: =7

            Gallery_Monday As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Monday_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =/*
                    Set(varSelectedDayOfWeek, 2);
                    Set(varSelectedSched_days, "Mondays");
                    If(
                        IsBlank(ThisItem.Day_Monday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Monday_text))
                    );
                    
                    Set(varRedirectedSchedScreen, true);
                    Set(varSelectedSchedSlot, ThisItem);
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text));
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text);
                    Set(varSelectedSched_ID, ThisItem.ID);
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text);
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1));
                    Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2));
                    Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                    Collect(selectedDesks,ThisItem);
                    
                    
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover)
                    */
                    
                    Concurrent(
                        // Set day-specific variables
                        Set(varSelectedDayOfWeek, 2),
                        Set(varSelectedSched_days, "Mondays"),
                        Set(varRedirectedSchedScreen, true),
                        
                        // Set item-specific variables
                        Set(varSelectedSchedSlot, ThisItem),
                        Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                        Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                        Set(varSelectedSched_ID, ThisItem.ID),
                        Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                        
                        // Set secondary and tertiary slot IDs
                        Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                        Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2))
                    );
                    
                    // Handle availability check (must be sequential due to If logic)
                    If(
                        IsBlank(ThisItem.Day_Monday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Monday_text))
                    );
                    
                    // Filter operations (must be sequential due to dependency on previous Sets)
                    Concurrent(
                        Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary)),
                        Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary)),
                        Collect(selectedDesks, ThisItem)
                    );
                    
                    // Navigate last
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover);
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =(Parent.Width - Gallery_Timeslot.Width) / 5
                X: =Gallery_Timeslot.X + Gallery_Timeslot.Width
                Y: =Header_Monday_2.Y + Header_Monday_2.Height
                ZIndex: =8

                Rectangle10_12 As rectangle:
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =2

                TextCanvas4_14 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    Size: |-
                        =If(
                            ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                            20
                        )
                    TabIndex: =0
                    Text: |-
                        =If(
                            IsBlank(ThisItem.Day_Monday_text),
                            "Available",
                            ThisItem.Day_Monday_text
                        )
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                Rectangle12_14 As rectangle:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    HoverFill: =Rectangle12_20.HoverFill
                    OnSelect: =Select(Parent)
                    PressedFill: =Rectangle12_20.PressedFill
                    Width: =70
                    X: =Rectangle12_20.X
                    Y: =Rectangle12_20.Y
                    ZIndex: =4

                Rectangle12_15 As rectangle:
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =5

                Button2_12 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    Fill: |-
                        =If(
                            IsBlank(ThisItem.Day_Monday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    Height: =Parent.TemplateHeight
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =
                    Width: =Parent.TemplateWidth
                    ZIndex: =6

            Gallery_Tuesday As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(0, 18, 107, 1)
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Tuesday_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Set(varSelectedSched_days, "Tuesdays");
                    If(
                        IsBlank(ThisItem.Day_Tuesday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Tuesday_text))
                    );
                    
                    Set(varRedirectedSchedScreen, true);
                    Set(varSelectedSchedSlot, ThisItem);
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text));
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text);
                    Set(varSelectedSched_ID, ThisItem.ID);
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text);
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1));
                    Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2));
                    Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                    Collect(selectedDesks,ThisItem);
                    Set(varSelectedDayOfWeek, 3);
                    
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover)
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =(Parent.Width - Gallery_Timeslot.Width) / 5
                X: =Gallery_Monday.X + Gallery_Monday.Width
                Y: =Header_Tuesday_2.Y + Header_Tuesday_2.Height
                ZIndex: =9

                Rectangle10_13 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =1

                Button2_13 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: |-
                        =If(
                            IsBlank(ThisItem.Day_Tuesday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    FontWeight: =FontWeight.Semibold
                    Height: =Parent.TemplateHeight
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =
                    Width: =Parent.TemplateWidth
                    ZIndex: =2

                TextCanvas4_15 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    PaddingTop: =0
                    Size: |-
                        =If(
                            ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                            20
                        )
                    TabIndex: =0
                    Text: |-
                        =If(
                            IsBlank(ThisItem.Day_Tuesday_text),
                            "Available",
                            ThisItem.Day_Tuesday_text
                        )
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                Rectangle12_16 As rectangle:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    HoverFill: =Rectangle12_20.HoverFill
                    OnSelect: =Select(Parent)
                    PressedFill: =RGBA(56, 96, 178, .50)
                    Width: =70
                    X: =Rectangle12_20.X
                    Y: =Rectangle12_20.Y
                    ZIndex: =4

                Rectangle12_17 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =RGBA(56, 96, 178, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =5

            Gallery_Wednesday As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(0, 18, 107, 1)
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Wednesday_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Set(varSelectedSched_days, "Wednesdays");
                    If(
                        IsBlank(ThisItem.Day_Wednesday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Wednesday_text))
                    );
                    
                    Set(varRedirectedSchedScreen, true);
                    Set(varSelectedSchedSlot, ThisItem);
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text));
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text);
                    Set(varSelectedSched_ID, ThisItem.ID);
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text);
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1));
                    Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2));
                    Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                    Collect(selectedDesks,ThisItem);
                    Set(varSelectedDayOfWeek, 4);
                    
                    
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover)
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =(Parent.Width - Gallery_Timeslot.Width) / 5
                X: =Gallery_Tuesday.X + Gallery_Tuesday.Width
                Y: =Header_Wednesday_2.Y + Header_Wednesday_2.Height
                ZIndex: =10

                Rectangle10_14 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =1

                Button2_14 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: |-
                        =If(
                            IsBlank(ThisItem.Day_Wednesday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    FontWeight: =FontWeight.Semibold
                    Height: =Parent.TemplateHeight
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =
                    Width: =Parent.TemplateWidth
                    ZIndex: =2

                TextCanvas4_16 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    PaddingTop: =0
                    Size: |-
                        =If(
                            ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                            20
                        )
                    TabIndex: =0
                    Text: |-
                        =If(
                            IsBlank(ThisItem.Day_Wednesday_text),
                            "Available",
                            ThisItem.Day_Wednesday_text
                        )
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                Rectangle12_18 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =Rectangle12_20.Fill
                    Height: =5.3125
                    HoverFill: =Rectangle12_20.HoverFill
                    OnSelect: =Select(Parent)
                    PressedFill: =Rectangle12_20.PressedFill
                    Width: =70
                    X: =Rectangle12_20.X
                    Y: =Rectangle12_20.Y
                    ZIndex: =4

                Rectangle8_3 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =RGBA(56, 96, 178, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =5

            Gallery_Thursday As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(0, 18, 107, 1)
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Thursday_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Set(varSelectedSched_days, "Thursdays");
                    If(
                        IsBlank(ThisItem.Day_Thursday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Thursday_text))
                    );
                    
                    
                    Set(varRedirectedSchedScreen, true);
                    Set(varSelectedSchedSlot, ThisItem);
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text));
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text);
                    Set(varSelectedSched_ID, ThisItem.ID);
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text);
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1));
                    Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2));
                    Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                    Collect(selectedDesks,ThisItem);
                    Set(varSelectedDayOfWeek, 5);
                    
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover)
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =(Parent.Width - Gallery_Timeslot.Width) / 5
                X: =Gallery_Wednesday.X + Gallery_Wednesday.Width
                Y: =Header_Thursday_2.Y + Header_Thursday_2.Height
                ZIndex: =11

                Rectangle10_15 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =1

                Button2_15 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: |-
                        =If(
                            IsBlank(ThisItem.Day_Thursday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    FontWeight: =FontWeight.Semibold
                    Height: =Parent.TemplateHeight
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: |-
                        =If(
                            IsBlank(ThisItem.Day_Thursday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =
                    Width: =Parent.TemplateWidth
                    ZIndex: =2

                TextCanvas4_17 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    PaddingTop: =0
                    Size: |-
                        =If(
                            ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                            20
                        )
                    TabIndex: =0
                    Text: |-
                        =If(
                            IsBlank(ThisItem.Day_Thursday_text),
                            "Available",
                            ThisItem.Day_Thursday_text
                        )
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                Rectangle12_19 As rectangle:
                    BorderColor: =Rectangle12_20.BorderColor
                    Fill: =Rectangle12_20.Fill
                    Height: =5.3125
                    HoverFill: =Rectangle12_20.HoverFill
                    OnSelect: =Select(Parent)
                    PressedFill: =Rectangle12_20.PressedFill
                    Width: =70
                    X: =Rectangle12_20.X
                    Y: =Rectangle12_20.Y
                    ZIndex: =4

                Rectangle8_4 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =RGBA(56, 96, 178, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =5

            Gallery_Friday As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(0, 18, 107, 1)
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Friday_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Set(varSelectedSched_days, "Fridays");
                    If(
                        IsBlank(ThisItem.Day_Friday_text),
                        Set(varSelectedSched_Availibility, "Available"),
                        Set(varSelectedSched_Availibility, Text(ThisItem.Day_Friday_text))
                    );
                    
                    Set(varRedirectedSchedScreen, true);
                    Set(varSelectedSchedSlot, ThisItem);
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text));
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text);
                    Set(varSelectedSched_ID, ThisItem.ID);
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text);
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1));
                    Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2));
                    Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                    Collect(selectedDesks,ThisItem);
                    Set(varSelectedDayOfWeek, 6);
                    
                    
                    
                    Navigate(ModifyTimeSlot, ScreenTransition.Cover)
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =(Parent.Width - Gallery_Timeslot.Width) / 5
                X: =Gallery_Thursday.X + Gallery_Thursday.Width
                Y: =Header_Friday_2.Y + Header_Friday_2.Height
                ZIndex: =12

                Rectangle10_16 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =1

                Button2_16 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    Color: =
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: |-
                        =If(
                            IsBlank(ThisItem.Day_Friday_text),
                            Color.LightGreen,
                            Color.Red
                        )
                    FontWeight: =FontWeight.Semibold
                    Height: =Parent.TemplateHeight
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =
                    Width: =Parent.TemplateWidth
                    ZIndex: =2

                TextCanvas4_18 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =RGBA(0, 0, 0, 1)
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    PaddingTop: =0
                    Size: |-
                        =If(
                            ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                            20
                        )
                    TabIndex: =0
                    Text: |-
                        =If(
                            IsBlank(ThisItem.Day_Friday_text),
                            "Available",
                            ThisItem.Day_Friday_text
                        )
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width - 5
                    Wrap: =false
                    X: =5
                    Y: =0
                    ZIndex: =3

                Rectangle12_20 As rectangle:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =Parent.TemplateHeight
                    HoverFill: =RGBA(56, 96, 178, .50)
                    OnSelect: =Select(Parent)
                    PressedFill: =RGBA(56, 96, 178, .50)
                    Width: =Parent.Width
                    ZIndex: =4

                Rectangle8_5 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =RGBA(56, 96, 178, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =5

            Gallery_Timeslot As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(0, 18, 107, 1)
                BorderThickness: =5
                DelayItemLoading: =true
                DisplayMode: |-
                    =If(
                        IsBlank(dropdown_filterROOM.SelectedText),
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Height: =Parent.Height - Header_Timeslot_2.Height
                Items: |-
                    =If(
                        !IsBlank(dropdown_filterROOM.SelectedText),
                        With(
                            {
                                selBldg: dropdown_filterBLDG.Selected.Value,
                                selRoom: dropdown_filterROOM.Selected.Value
                            },
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            )),
                        Blank()
                    )
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =Self.Height / 16
                Width: =112
                Y: =Header_Timeslot_2.Y + Header_Timeslot_2.Height
                ZIndex: =13

                Rectangle10_17 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    BorderThickness: =1
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =5.3125
                    OnSelect: =Select(Parent)
                    Visible: =false
                    Width: =Parent.Width - 1
                    ZIndex: =1

                Button2_17 As button:
                    BorderColor: =RGBA(9, 33, 98, 1)
                    BorderThickness: =0
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =RGBA(0, 0, 0, 0)
                    FontWeight: =FontWeight.Semibold
                    Height: =Parent.TemplateHeight
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =ThisItem.TimeSlot_Start_text
                    Width: =Parent.TemplateWidth
                    ZIndex: =2

                TextCanvas4_19 As Text:
                    Align: ='TextCanvas.Align'.Center
                    AutoHeight: =false
                    BorderColor: =
                    BorderStyle: =BorderStyle.Solid
                    BorderThickness: =0
                    ContentLanguage: =""
                    DisplayMode: =DisplayMode.Edit
                    Fill: =
                    Font: =Font.'Lato Black'
                    FontColor: =
                    FontItalic: =false
                    FontStrikethrough: =false
                    FontUnderline: =false
                    Height: =Parent.TemplateHeight
                    PaddingTop: =0
                    Size: =12
                    TabIndex: =0
                    Text: =ThisItem.TimeSlot_text
                    Tooltip: =""
                    VerticalAlign: =VerticalAlign.Middle
                    Visible: =true
                    Weight: ='TextCanvas.Weight'.Bold
                    Width: =Parent.Width - Self.X
                    Wrap: =false
                    X: =0
                    Y: =0
                    ZIndex: =3

                Rectangle12_21 As rectangle:
                    BorderColor: =RGBA(0, 18, 107, 1)
                    Fill: =RGBA(56, 96, 178, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.Width
                    Y: =Parent.TemplateHeight - 2
                    ZIndex: =4

            ButtonCanvas2_1 As Button:
                AcceptsFocus: =true
                AccessibleLabel: =""
                Align: =""
                Appearance: ="Primary"
                BasePaletteColor: =RGBA(135, 123, 123, 1)
                BorderColor: =
                BorderStyle: =""
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Font: =""
                FontColor: =
                FontItalic: =false
                FontSize: =45
                FontStrikethrough: =false
                FontUnderline: =false
                FontWeight: =FontWeight.Bold
                Height: =Parent.Height
                Icon: =""
                IconRotation: =0
                IconStyle: ="Outline"
                Layout: ="Icon before"
                OnSelect: =false
                TabIndex: =0
                Text: ="Choose a specific CBOC and room with the slicers above to populate the schedule...."
                Tooltip: =""
                VerticalAlign: =""
                Visible: |-
                    =If(
                        IsBlank(dropdown_filterROOM.Selected.Value),
                        true,
                        false
                    )
                Width: =Parent.Width
                X: =0
                Y: =0
                ZIndex: =15

    icon_Reload As icon:
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =Color.DarkBlue
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        Height: =btnRefresh.Height
        Icon: =Icon.Reload
        OnSelect: |
            =Reset(dropdown_filterBLDG);
            Reset(dropdown_filterROOM);
            Set(varBuilding, Blank());
            Set(varSelectedSched_CBOCName, Blank());
            Set(varRoomNumberSelected, Blank());
            Set(varRoomNumberSelectionText, Blank());
            ClearCollect(col_CombiTable, TelehealthMasterSched_CombiTable);
            If(
                IsBlank(varSchedScreenInstructions_visible),
                Set(varSchedScreenInstructions_visible, true)
            );
            Set(varSelectedDayOfWeek, Blank());
            
            
            Set(varVacantBlocksQTY, Blank());
            With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize selections (Blank() = no filter)
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                With(
                                    {
                                        colorNumber: "#b80000",   // color for the numeric count
                                        colorEntity: "#004b87"    // color for building / room text
                                    },
                                    If(
                                        IsBlank(selBldg),
                                        // CASE 1: No building selected (or "All")
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
            
                                        If(
                                            IsBlank(selRoom),
                                            // CASE 2: Building only
                                               Set(varVacantBlocksQTY, vacantBlocks),
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>",
            
                                            // CASE 3: Building + Room
                                               Set(varVacantBlocksQTY, vacantBlocks)
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                               //Text(selRoom) &
                                               //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>"
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        Width: =btnRefresh.Width
        X: =btnRefresh.X
        Y: =btnUser.Y
        ZIndex: =2

    icon_Home As icon.Home:
        Color: =Color.DarkBlue
        Height: =60
        Icon: =Icon.Home
        OnSelect: |-
            =Set(varRedirectedSchedScreen, false);
            Navigate(Dashboard);
        PaddingBottom: =10
        PaddingLeft: =10
        PaddingRight: =10
        PaddingTop: =10
        Width: =65
        X: =btnHome.X
        Y: =btnHome.Y
        ZIndex: =3

    img_userAccount As image:
        BorderThickness: =1
        Height: =btnUser.Height
        Image: =Office365Users.UserPhotoV2(User().Email)
        OnSelect: =//Navigate(ManageUsers)
        RadiusBottomLeft: =180
        RadiusBottomRight: =180
        RadiusTopLeft: =180
        RadiusTopRight: =180
        Width: =btnUser.Width
        X: =btnUser.X
        Y: =btnUser.Y
        ZIndex: =4

    lbl_filterBLDG As Text:
        AutoHeight: =true
        BorderColor: =
        DisplayMode: =DisplayMode.Edit
        Fill: =
        FontColor: =
        Height: =32
        Text: |-
            ="CBOC Location:"
        Width: =96
        X: =5
        Y: =0
        ZIndex: =5

    lbl_filterROOM As Text:
        Align: ="Start"
        AutoHeight: =true
        BorderColor: =
        BorderStyle: =""
        ContentLanguage: =""
        DisplayMode: =DisplayMode.Edit
        Fill: =
        Font: =""
        FontColor: =
        FontItalic: =false
        FontStrikethrough: =false
        FontUnderline: =false
        Height: =32
        Size: =14
        TabIndex: =0
        Text: |-
            ="Room Number:"
        Tooltip: =""
        VerticalAlign: =""
        Visible: =true
        Weight: ="Regular"
        Width: =96
        Wrap: =true
        X: =340
        Y: =lbl_filterBLDG.Y
        ZIndex: =6

    lbl_filterACTIVEstatus As Text:
        Align: ="Start"
        AutoHeight: =true
        BorderColor: =
        BorderStyle: =""
        ContentLanguage: =""
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(255, 0, 0, 1)
        Font: =""
        FontColor: =
        FontItalic: =false
        FontStrikethrough: =false
        FontUnderline: =false
        Height: =32
        Size: =14
        TabIndex: =0
        Text: ="Other"
        Tooltip: =""
        VerticalAlign: =""
        Visible: =false
        Weight: ="Regular"
        Width: =96
        Wrap: =true
        X: =761
        Y: =icon_Home.Y
        ZIndex: =7

    dropdown_filterBLDG As dropdown:
        AllowEmptySelection: =true
        Default: ="...Pick one!"
        Height: =45
        Items: |-
            =Sort(
                    Distinct(
                        col_CombiTable,
                        Coalesce(
                            CBOC_Name_text,
                            CBOC_Name_text)
                    ),
                    Value,
                    SortOrder.Ascending
                )
        OnChange: |-
            =Set(
                varBuilding,
                dropdown_filterBLDG.Selected.Value
            );
            Reset(dropdown_filterROOM);
            
            With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize selections (Blank() = no filter)
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                With(
                                    {
                                        colorNumber: "#b80000",   // color for the numeric count
                                        colorEntity: "#004b87"    // color for building / room text
                                    },
                                    If(
                                        IsBlank(selBldg),
                                        // CASE 1: No building selected (or "All")
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
            
                                        If(
                                            IsBlank(selRoom),
                                            // CASE 2: Building only
                                               Set(varVacantBlocksQTY, vacantBlocks),
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>",
            
                                            // CASE 3: Building + Room
                                               Set(varVacantBlocksQTY, vacantBlocks)
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                               //Text(selRoom) &
                                               //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>"
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        OnSelect: |-
            =Set(
                varBuilding,
                dropdown_filterBLDG.Selected.Value
            );
            Reset(dropdown_filterROOM);
            
            With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize selections (Blank() = no filter)
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                With(
                                    {
                                        colorNumber: "#b80000",   // color for the numeric count
                                        colorEntity: "#004b87"    // color for building / room text
                                    },
                                    If(
                                        IsBlank(selBldg),
                                        // CASE 1: No building selected (or "All")
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
            
                                        If(
                                            IsBlank(selRoom),
                                            // CASE 2: Building only
                                               Set(varVacantBlocksQTY, vacantBlocks),
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>",
            
                                            // CASE 3: Building + Room
                                               Set(varVacantBlocksQTY, vacantBlocks)
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                               //Text(selRoom) &
                                               //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>"
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        Reset: =true
        Size: =21
        Width: =300
        X: =lbl_filterBLDG.X + 25
        Y: =lbl_filterBLDG.Y + lbl_filterBLDG.Height
        ZIndex: =8

    dropdown_filterROOM As dropdown:
        AllowEmptySelection: =true
        Default: ="...Pick one!"
        DisplayMode: |-
            =If(
                IsBlank(dropdown_filterBLDG.SelectedText),
                DisplayMode.Disabled,
                DisplayMode.Edit
            )
        Height: =45
        Items: |-
            =Sort(
                Distinct(
                    If(
                        IsBlank(dropdown_filterBLDG.Selected.Value) || dropdown_filterBLDG.Selected.Value = "All",
                        col_CombiTable,
                        Filter(
                            col_CombiTable,
                            Coalesce(
                                CBOC_Name_text,
                                CBOC_Name_text
                            ) = dropdown_filterBLDG.Selected.Value
                        )
                    ),
                    Coalesce(
                        Room_number,
                        Room_number
                    )
                ),
                Value,
                SortOrder.Ascending
            )
            //[("Aurora 120"), ("Aurora 121"), ("Hoffman Estates 103"), ("Hoffman Estates 104"), ("Hoffman Estates 105"), ("Hoffman Estates 106"), ("Joliet 1010"), ("Joliet 1011"), ("Joliet 1012"), ("Joliet 1013"), ("Kankakee 103"), ("Kankakee 104"), ("Kankakee 113"), ("Lasalle 127"), ("Lasalle 128"), ("Lasalle 129"), ("Lasalle 130"), ("Oak Lawn 102"), ("Oak Lawn 103"), ("Oak Lawn 104"), ("Oak Lawn 105")]
        OnChange: |-
            =Set(varRoomNumberSelectionText, dropdown_filterROOM.SelectedText);
            Set(varRoomNumberSelected, Coalesce(dropdown_filterROOM.Selected.Value, dropdown_filterROOM.Selected.Value));
            
            With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize selections (Blank() = no filter)
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                With(
                                    {
                                        colorNumber: "#b80000",   // color for the numeric count
                                        colorEntity: "#004b87"    // color for building / room text
                                    },
                                    If(
                                        IsBlank(selBldg),
                                        // CASE 1: No building selected (or "All")
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
            
                                        If(
                                            IsBlank(selRoom),
                                            // CASE 2: Building only
                                               Set(varVacantBlocksQTY, vacantBlocks),
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>",
            
                                            // CASE 3: Building + Room
                                               Set(varVacantBlocksQTY, vacantBlocks)
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                               //Text(selRoom) &
                                               //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>"
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        OnSelect: |-
            =Set(varRoomNumberSelectionText, dropdown_filterROOM.SelectedText);
            Set( varRoomNumberSelected, Coalesce( dropdown_filterROOM.Selected.Value, dropdown_filterROOM.Selected.Value ) );
            ClearCollect(
                col_FilteredClinics,
                Filter(
                    col_TelehealthClinics,
                    StartsWith(
                        VistA_Clinic_Name,
                        Switch(
                            dropdown_filterBLDG.Selected.Value,
                            "Aurora", "AUR",
                            "Hoffman Estates", "HE", 
                            "Joliet", "JOL",
                            "Kankakee", "KAN",
                            "Lasalle", "LAS",
                            "Oak Lawn", "OL",
                            ""  // Default case - no filter
                        )
                    )
                )
            );
            
            With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize selections (Blank() = no filter)
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                With(
                                    {
                                        colorNumber: "#b80000",   // color for the numeric count
                                        colorEntity: "#004b87"    // color for building / room text
                                    },
                                    If(
                                        IsBlank(selBldg),
                                        // CASE 1: No building selected (or "All")
                                           Set(varVacantBlocksQTY, vacantBlocks),
                                           //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                           //Text(vacantBlocks) &
                                           //"</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
            
                                        If(
                                            IsBlank(selRoom),
                                            // CASE 2: Building only
                                               Set(varVacantBlocksQTY, vacantBlocks),
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>",
            
                                            // CASE 3: Building + Room
                                               Set(varVacantBlocksQTY, vacantBlocks)
                                               //"<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                               //Text(vacantBlocks) &
                                               //"</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                               //Text(selRoom) &
                                               //"</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                               //selBldg &
                                               //" CBOC</u></span>.</p>"
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        Reset: =true
        Size: =21
        Width: =125
        X: =lbl_filterROOM.X + 15
        Y: =dropdown_filterBLDG.Y
        ZIndex: =9

    dropdown_filterACTIVEstatus As dropdown:
        BorderColor: =RGBA(0, 18, 107, 1)
        ChevronBackground: =RGBA(56, 96, 178, 1)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronHoverBackground: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =0
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(186, 202, 226, 1)
        Items: |-
            =//DropDownSample
            col_Desks
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(0, 18, 107, 1)
        SelectionFill: =RGBA(56, 96, 178, 1)
        Size: =21
        Visible: =false
        Width: =300
        X: =533
        Y: =icon_Home.Y + lbl_filterBLDG.Height
        ZIndex: =10

    container_Schedule_Single As groupContainer.manualLayoutContainer:
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width
        Y: =icon_Home.Y + icon_Home.Height + 10
        ZIndex: =11

        Header_Timeslot_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Time:"
            Width: =Gallery_Timeslot_0.Width
            X: =Gallery_Timeslot_0.X
            ZIndex: =1

        Header_Monday_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Monday:"
            Width: =Gallery_Monday_1.Width
            X: =Gallery_Monday_1.X
            ZIndex: =2

        Header_Tuesday_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Tuesday:"
            Width: =Gallery_Tuesday_2.Width
            X: =Gallery_Tuesday_2.X
            ZIndex: =3

        Header_Wednesday_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Wednesday:"
            Width: =Gallery_Wednesday_3.Width
            X: =Gallery_Wednesday_3.X
            ZIndex: =4

        Header_Thursday_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Thursday:"
            Width: =Gallery_Thursday_4.Width
            X: =Gallery_Thursday_4.X
            ZIndex: =5

        Header_Friday_1 As button:
            Height: =35
            Size: =16
            Text: |-
                ="Friday:"
            Width: =Gallery_Friday_5.Width
            X: =Gallery_Friday_5.X
            ZIndex: =6

        Gallery_Monday_1 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =Gallery_Friday_5.Fill
            Height: =Parent.Height - Header_Monday_1.Height
            Items: |-
                =With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =Concurrent(
                    Set(varSelectedDayOfWeek, 2),
                    Set(varSelectedSched_days, "Mondays"),
                    Set(varRedirectedSchedScreen, true),
                    Set(varSelectedSchedSlot, ThisItem),
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                    Set(varSelectedSched_ID, ThisItem.ID),
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2)),
                    Set(varSelectedSched_Availibility, 
                        If(IsBlank(ThisItem.Day_Monday_text), "Available", Text(ThisItem.Day_Monday_text))
                    ),
                    Collect(selectedDesks, ThisItem)
                );
                
                Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                
                Navigate(ModifyTimeSlot, ScreenTransition.Cover)
            TemplatePadding: =0
            TemplateSize: =Self.Height / 16
            Width: =(Parent.Width - Gallery_Timeslot_0.Width) / 5
            X: =Gallery_Timeslot_0.X + Gallery_Timeslot_0.Width
            Y: =Header_Monday_1.Y + Header_Monday_1.Height
            ZIndex: =7

            btnHoverSelector_DEPRECIATED_1 As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width
                Y: =Parent.TemplateHeight - 2
                ZIndex: =1

            shape_DEPRECIATED_1 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =2

            btnBackgroundColor_1 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Fill: |-
                    =If(
                        IsBlank(ThisItem.Day_Monday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth
                ZIndex: =3

            lblClinicName_1 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =lblClinicName_5.Height
                PaddingTop: =
                Size: |-
                    =If(
                        ThisItem.Day_Monday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                        Len(ThisItem.Day_Monday_text) > 20,
                            16,
                        Len(ThisItem.Day_Monday_text) > 25,
                            12,
                        Len(ThisItem.Day_Monday_text) > 30,
                            8,
                        20
                    )
                TabIndex: =0
                Text: |-
                    =If(
                        IsBlank(ThisItem.Day_Monday_text),
                        "Available",
                        ThisItem.Day_Monday_text
                    )
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =lblClinicName_5.Width
                Wrap: |-
                    =If(
                        Len(ThisItem.Day_Monday_text) > 25,
                        true,
                        false
                    )
                X: =0
                Y: =0
                ZIndex: =4

            shape_rowSeperator_1 As rectangle:
                BorderColor: =shape_rowSeperator_5.BorderColor
                BorderThickness: =shape_rowSeperator_5.BorderThickness
                Fill: =RGBA(0, 0, 0, 0)
                Height: =shape_rowSeperator_5.Height
                HoverFill: =btnHoverSelector_DEPRECIATED_5.HoverFill
                OnSelect: =Select(Parent)
                PressedFill: =btnHoverSelector_DEPRECIATED_5.PressedFill
                Width: =btnHoverSelector_DEPRECIATED_5.Width
                X: =btnHoverSelector_DEPRECIATED_5.X
                Y: =shape_rowSeperator_5.Y
                ZIndex: =5

            btnHoverSelector_NEW_1 As button:
                AutoDisableOnSelect: =false
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =5
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FontWeight: =FontWeight.Semibold
                Height: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                HoverBorderColor: =RGBA(255, 255, 255, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(109, 49, 162, .5)
                OnSelect: =Select(Parent)
                PressedBorderColor: =Self.HoverBorderColor
                PressedColor: =Self.HoverColor
                PressedFill: =Self.HoverFill
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth - (Self.BorderThickness * 2)
                X: =(Parent.TemplateWidth - Self.Width) / 2
                Y: =(Parent.TemplateHeight - Self.Height) / 2
                ZIndex: =6

        Gallery_Tuesday_2 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =Gallery_Friday_5.Fill
            Height: =Parent.Height - Header_Tuesday_1.Height
            Items: |-
                =With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =Concurrent(
                    Set(varSelectedDayOfWeek, 3),
                    Set(varSelectedSched_days, "Tuesdays"),
                    Set(varRedirectedSchedScreen, true),
                    Set(varSelectedSchedSlot, ThisItem),
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                    Set(varSelectedSched_ID, ThisItem.ID),
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2)),
                    Set(varSelectedSched_Availibility, 
                        If(IsBlank(ThisItem.Day_Tuesday_text), "Available", Text(ThisItem.Day_Tuesday_text))
                    ),
                    Collect(selectedDesks, ThisItem)
                );
                
                Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                
                Navigate(ModifyTimeSlot, ScreenTransition.Cover)
            TemplatePadding: =0
            TemplateSize: =Self.Height / 16
            Width: =(Parent.Width - Gallery_Timeslot_0.Width) / 5
            X: =Gallery_Monday_1.X + Gallery_Monday_1.Width
            Y: =Header_Tuesday_1.Y + Header_Tuesday_1.Height
            ZIndex: =8

            btnHoverSelector_DEPRECIATED_2 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =btnHoverSelector_DEPRECIATED_5.Height
                HoverFill: =btnHoverSelector_DEPRECIATED_5.HoverFill
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(56, 96, 178, .50)
                Visible: =false
                Width: =btnHoverSelector_DEPRECIATED_5.Width
                X: =btnHoverSelector_DEPRECIATED_5.X
                Y: =btnHoverSelector_DEPRECIATED_5.Y
                ZIndex: =1

            shape_DEPRECIATED_2 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =2

            btnBackgroundColor_2 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Fill: |-
                    =If(
                        IsBlank(ThisItem.Day_Tuesday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth
                ZIndex: =3

            lblClinicName_2 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =lblClinicName_5.Height
                PaddingTop: =0
                Size: |-
                    =If(
                        ThisItem.Day_Tuesday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                        Len(ThisItem.Day_Tuesday_text) > 20,
                            16,
                        Len(ThisItem.Day_Tuesday_text) > 25,
                            12,
                        Len(ThisItem.Day_Tuesday_text) > 30,
                            8,
                        20
                    )
                TabIndex: =0
                Text: |-
                    =If(
                        IsBlank(ThisItem.Day_Tuesday_text),
                        "Available",
                        ThisItem.Day_Tuesday_text
                    )
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =lblClinicName_5.Width
                Wrap: |-
                    =If(
                        Len(ThisItem.Day_Tuesday_text) > 20,
                        true,
                        false
                    )
                X: =0
                Y: =0
                ZIndex: =4

            shape_rowSeperator_2 As rectangle:
                BorderColor: =shape_rowSeperator_5.BorderColor
                BorderThickness: =shape_rowSeperator_5.BorderThickness
                Height: =shape_rowSeperator_5.Height
                OnSelect: =Select(Parent)
                Width: =Parent.Width
                Y: =shape_rowSeperator_5.Y
                ZIndex: =5

            btnHoverSelector_NEW_2 As button:
                AutoDisableOnSelect: =false
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =5
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FontWeight: =FontWeight.Semibold
                Height: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                HoverBorderColor: =RGBA(255, 255, 255, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(109, 49, 162, .5)
                OnSelect: =Select(Parent)
                PressedBorderColor: =Self.HoverBorderColor
                PressedColor: =Self.HoverColor
                PressedFill: =Self.HoverFill
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth - (Self.BorderThickness * 2)
                X: =(Parent.TemplateWidth - Self.Width) / 2
                Y: =(Parent.TemplateHeight - Self.Height) / 2
                ZIndex: =6

        Gallery_Wednesday_3 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =Gallery_Friday_5.Fill
            Height: =Parent.Height - Header_Wednesday_1.Height
            Items: |-
                =With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =Concurrent(
                    Set(varSelectedDayOfWeek, 4),
                    Set(varSelectedSched_days, "Wednesdays"),
                    Set(varRedirectedSchedScreen, true),
                    Set(varSelectedSchedSlot, ThisItem),
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                    Set(varSelectedSched_ID, ThisItem.ID),
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2)),
                    Set(varSelectedSched_Availibility, 
                        If(IsBlank(ThisItem.Day_Wednesday_text), "Available", Text(ThisItem.Day_Wednesday_text))
                    ),
                    Collect(selectedDesks, ThisItem)
                );
                
                Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                
                Navigate(ModifyTimeSlot, ScreenTransition.Cover)
            TemplatePadding: =0
            TemplateSize: =Self.Height / 16
            Width: =(Parent.Width - Gallery_Timeslot_0.Width) / 5
            X: =Gallery_Tuesday_2.X + Gallery_Tuesday_2.Width
            Y: =Header_Wednesday_1.Y + Header_Wednesday_1.Height
            ZIndex: =9

            btnHoverSelector_DEPRECIATED_3 As rectangle:
                Fill: =btnHoverSelector_DEPRECIATED_5.Fill
                Height: =btnHoverSelector_DEPRECIATED_5.Height
                HoverFill: =btnHoverSelector_DEPRECIATED_5.HoverFill
                OnSelect: =Select(Parent)
                PressedFill: =btnHoverSelector_DEPRECIATED_5.PressedFill
                Visible: =false
                Width: =btnHoverSelector_DEPRECIATED_5.Width
                X: =btnHoverSelector_DEPRECIATED_5.X
                Y: =btnHoverSelector_DEPRECIATED_5.Y
                ZIndex: =2

            shape_DEPRECIATED_3 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =3

            btnBackgroundColor_3 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Fill: |-
                    =If(
                        IsBlank(ThisItem.Day_Wednesday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth
                ZIndex: =4

            lblClinicName_3 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =lblClinicName_5.Height
                PaddingTop: =0
                Size: |-
                    =If(
                        ThisItem.Day_Wednesday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                        Len(ThisItem.Day_Wednesday_text) > 20,
                            16,
                        Len(ThisItem.Day_Wednesday_text) > 25,
                            12,
                        Len(ThisItem.Day_Wednesday_text) > 30,
                            8,
                        20
                    )
                TabIndex: =0
                Text: |-
                    =If(
                        IsBlank(ThisItem.Day_Wednesday_text),
                        "Available",
                        ThisItem.Day_Wednesday_text
                    )
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =lblClinicName_5.Width
                Wrap: |-
                    =If(
                        Len(ThisItem.Day_Wednesday_text) > 20,
                        true,
                        false
                    )
                X: =0
                Y: =0
                ZIndex: =5

            shape_rowSeperator_3 As rectangle:
                BorderColor: =shape_rowSeperator_5.BorderColor
                BorderThickness: =shape_rowSeperator_5.BorderThickness
                Height: =shape_rowSeperator_5.Height
                OnSelect: =Select(Parent)
                Width: =shape_rowSeperator_5.Width
                Y: =shape_rowSeperator_5.Y
                ZIndex: =6

            btnHoverSelector_NEW_3 As button:
                AutoDisableOnSelect: =false
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =5
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FontWeight: =FontWeight.Semibold
                Height: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                HoverBorderColor: =RGBA(255, 255, 255, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(109, 49, 162, .5)
                OnSelect: =Select(Parent)
                PressedBorderColor: =Self.HoverBorderColor
                PressedColor: =Self.HoverColor
                PressedFill: =Self.HoverFill
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth - (Self.BorderThickness * 2)
                X: =(Parent.TemplateWidth - Self.Width) / 2
                Y: =(Parent.TemplateHeight - Self.Height) / 2
                ZIndex: =7

        Gallery_Thursday_4 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =Gallery_Friday_5.Fill
            Height: =Parent.Height - Header_Thursday_1.Height
            Items: |-
                =With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =Concurrent(
                    Set(varSelectedDayOfWeek, 5),
                    Set(varSelectedSched_days, "Thursdays"),
                    Set(varRedirectedSchedScreen, true),
                    Set(varSelectedSchedSlot, ThisItem),
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                    Set(varSelectedSched_ID, ThisItem.ID),
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2)),
                    Set(varSelectedSched_Availibility, 
                        If(IsBlank(ThisItem.Day_Thursday_text), "Available", Text(ThisItem.Day_Thursday_text))
                    ),
                    Collect(selectedDesks, ThisItem)
                );
                
                Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                
                Navigate(ModifyTimeSlot, ScreenTransition.Cover)
            TemplatePadding: =0
            TemplateSize: =Self.Height / 16
            Width: =(Parent.Width - Gallery_Timeslot_0.Width) / 5
            X: =Gallery_Wednesday_3.X + Gallery_Wednesday_3.Width
            Y: =Header_Thursday_1.Y + Header_Thursday_1.Height
            ZIndex: =10

            btnHoverSelector_DEPRECIATED_4 As rectangle:
                BorderColor: =btnHoverSelector_DEPRECIATED_5.BorderColor
                Fill: =btnHoverSelector_DEPRECIATED_5.Fill
                Height: =btnHoverSelector_DEPRECIATED_5.Height
                HoverFill: =btnHoverSelector_DEPRECIATED_5.HoverFill
                OnSelect: =Select(Parent)
                PressedFill: =btnHoverSelector_DEPRECIATED_5.PressedFill
                Visible: =false
                Width: =btnHoverSelector_DEPRECIATED_5.Width
                X: =btnHoverSelector_DEPRECIATED_5.X
                Y: =btnHoverSelector_DEPRECIATED_5.Y
                ZIndex: =1

            shape_DEPRECIATED_4 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =2

            btnBackgroundColor_4 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Fill: |-
                    =If(
                        IsBlank(ThisItem.Day_Thursday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                Height: =Parent.TemplateHeight
                OnSelect: |-
                    =If(
                        IsBlank(ThisItem.Day_Thursday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth
                ZIndex: =3

            lblClinicName_4 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =lblClinicName_5.Height
                PaddingTop: =0
                Size: |-
                    =If(
                        ThisItem.Day_Thursday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                        Len(ThisItem.Day_Thursday_text) > 20,
                            16,
                        Len(ThisItem.Day_Thursday_text) > 25,
                            12,
                        Len(ThisItem.Day_Thursday_text) > 30,
                            8,
                        20
                    )
                TabIndex: =0
                Text: |-
                    =If(
                        IsBlank(ThisItem.Day_Thursday_text),
                        "Available",
                        ThisItem.Day_Thursday_text
                    )
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =lblClinicName_5.Width
                Wrap: |-
                    =If(
                        Len(ThisItem.Day_Thursday_text) > 20,
                        true,
                        false
                    )
                X: =0
                Y: =0
                ZIndex: =4

            shape_rowSeperator_4 As rectangle:
                BorderColor: =shape_rowSeperator_5.BorderColor
                BorderThickness: =shape_rowSeperator_5.BorderThickness
                Height: =1
                OnSelect: =Select(Parent)
                Width: =shape_rowSeperator_5.Width
                Y: =shape_rowSeperator_5.Y
                ZIndex: =5

            btnHoverSelector_NEW As button:
                AutoDisableOnSelect: =false
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =5
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                HoverBorderColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(109, 49, 162, .5)
                OnSelect: =Select(Parent)
                PressedBorderColor: =Self.HoverBorderColor
                PressedColor: =Self.HoverColor
                PressedFill: =Self.HoverFill
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth - (Self.BorderThickness * 2)
                X: =(Parent.TemplateWidth - Self.Width) / 2
                Y: =(Parent.TemplateHeight - Self.Height) / 2
                ZIndex: =6

        Gallery_Friday_5 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height - Header_Friday_1.Height
            Items: |-
                =With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            OnSelect: |-
                =Concurrent(
                    Set(varSelectedDayOfWeek, 6),
                    Set(varSelectedSched_days, "Fridays"),
                    Set(varRedirectedScredScreen, true),
                    Set(varSelectedSchedSlot, ThisItem),
                    Set(varSelectedSched_time, Text(ThisItem.TimeSlot_text)),
                    Set(varSelectedSched_CBOCName, ThisItem.CBOC_Name_text),
                    Set(varSelectedSched_ID, ThisItem.ID),
                    Set(varSelectedSchedSlot_startTime_text, ThisItem.TimeSlot_Start_text),
                    Set(varSelectedSchedSlot_secondary, (ThisItem.ID + 1)),
                    Set(varSelectedSchedSlot_tertiary, (ThisItem.ID + 2)),
                    Set(varSelectedSched_Availibility, 
                        If(IsBlank(ThisItem.Day_Friday_text), "Available", Text(ThisItem.Day_Friday_text))
                    ),
                    Collect(selectedDesks, ThisItem)
                );
                
                Set(varSelectedSchedSlot_secondarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_secondary));
                Set(varSelectedSchedSlot_tertiarySlot, Filter(col_CombiTable, ThisRecord.ID = varSelectedSchedSlot_tertiary));
                
                Navigate(ModifyTimeSlot, ScreenTransition.Cover)
            TemplatePadding: =0
            TemplateSize: =(Self.Height / 16)
            Width: =(Parent.Width - Gallery_Timeslot_0.Width) / 5
            X: =Gallery_Thursday_4.X + Gallery_Thursday_4.Width
            Y: =Header_Friday_1.Y + Header_Friday_1.Height
            ZIndex: =12

            shape_DEPRECIATED_5 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =1

            btnHoverSelector_DEPRECIATED_5 As rectangle:
                BorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(56, 96, 178, .60)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(56, 96, 178, .50)
                Visible: =false
                Width: =Parent.Width
                Y: =(Parent.TemplateHeight - 2) - Self.Height
                ZIndex: =2

            btnBackgroundColor_5 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Color: =
                Fill: |-
                    =If(
                        IsBlank(ThisItem.Day_Friday_text),
                        Color.LightGreen,
                        Color.Red
                    )
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth
                ZIndex: =3

            lblClinicName_5 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =RGBA(0, 0, 0, 1)
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =Parent.TemplateHeight // 36
                PaddingTop: =0
                Size: |-
                    =If(
                        ThisItem.Day_Friday_text = "TCT LUNCH 12:15- 12:45",
                            12,
                        Len(ThisItem.Day_Friday_text) > 20,
                            16,
                        Len(ThisItem.Day_Friday_text) > 25,
                            12,
                        Len(ThisItem.Day_Friday_text) > 30,
                            8,
                        20
                    )
                TabIndex: =0
                Text: |-
                    =If(
                        IsBlank(ThisItem.Day_Friday_text),
                        "Available",
                        ThisItem.Day_Friday_text
                    )
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =Parent.TemplateWidth // Parent.Width - 5
                Wrap: =If(Len(ThisItem.Day_Friday_text) > 20, true, false)
                X: =0
                Y: =0
                ZIndex: =4

            shape_rowSeperator_5 As rectangle:
                BorderThickness: =0.5
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.Width
                Y: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                ZIndex: =5

            btnHoverSelector_NEW_5 As button:
                AutoDisableOnSelect: =false
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =5
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.TemplateHeight - (Self.BorderThickness * 2)
                HoverBorderColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(109, 49, 162, .5)
                OnSelect: =Select(Parent)
                PressedBorderColor: =Self.HoverBorderColor
                PressedColor: =Self.HoverColor
                PressedFill: =Self.HoverFill
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =
                Width: =Parent.TemplateWidth - (Self.BorderThickness * 2)
                X: =(Parent.TemplateWidth - Self.Width) / 2
                Y: =(Parent.TemplateHeight - Self.Height) / 2
                ZIndex: =6

        Gallery_Timeslot_0 As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderThickness: =5
            DelayItemLoading: =true
            DisplayMode: |-
                =If(
                    IsBlank(dropdown_filterROOM.SelectedText),
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height - Header_Timeslot_1.Height
            Items: |-
                =/*If(
                    !IsBlank(dropdown_filterROOM.SelectedText),
                    With(
                        {
                            selBldg: dropdown_filterBLDG.Selected.Value,
                            selRoom: dropdown_filterROOM.Selected.Value
                        },
                        Filter(
                            col_CombiTable,
                            IsBlank(selBldg) || selBldg = "All" || Coalesce(field_1, CBOC_Name_text) = selBldg,
                            IsBlank(selRoom) || Coalesce(field_2, Room_number) = selRoom
                        )),
                    Blank()
                )
                */
                With(
                    {
                        selBldg: dropdown_filterBLDG.Selected.Value,
                        selRoom: dropdown_filterROOM.Selected.Value
                    },
                    If(
                        IsBlank(selBldg) && IsBlank(selRoom),
                        Blank(),
                        FirstN(
                            Filter(
                                col_CombiTable,
                                IsBlank(selBldg) || selBldg = "All" || Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg,
                                IsBlank(selRoom) || Coalesce(Room_number, Room_number) = selRoom
                            ),
                            16
                        )
                    )
                )
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =Self.Height / 16
            Width: =113
            Y: =Header_Timeslot_1.Y + Header_Timeslot_1.Height
            ZIndex: =13

            Rectangle10_6 As rectangle:
                BorderThickness: =1
                Fill: =RGBA(0, 0, 0, 0)
                Height: =36
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =Parent.Width - 1
                ZIndex: =8

            Button2_6 As button:
                BorderColor: =RGBA(9, 33, 98, 1)
                BorderThickness: =0
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =//ThisItem.TimeSlot_Start_text
                Width: =Parent.TemplateWidth
                ZIndex: =9

            lblTimeSlot_0 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.'Lato Black'
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =Parent.TemplateHeight
                PaddingTop: =0
                Size: =12
                TabIndex: =0
                Text: =ThisItem.TimeSlot_text
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ='TextCanvas.Weight'.Bold
                Width: =Parent.Width - Self.X
                Wrap: |-
                    =If(
                        Len(ThisItem.Day_Friday_text) > 20,
                        true,
                        false
                    )
                X: =0
                Y: =0
                ZIndex: =10

            lblClinicName_0 As rectangle:
                BorderColor: =shape_rowSeperator_5.BorderColor
                BorderThickness: =shape_rowSeperator_5.BorderThickness
                Height: =shape_rowSeperator_5.Height
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =shape_rowSeperator_5.Y
                ZIndex: =11

        ButtonCanvas2 As Button:
            BasePaletteColor: =RGBA(135, 123, 123, 1)
            BorderColor: =
            DisplayMode: =DisplayMode.Edit
            FontColor: =
            FontSize: =45
            FontWeight: =FontWeight.Bold
            Height: =Parent.Height + 10
            Text: ="Choose a specific CBOC and room with the slicers above to populate the schedule...."
            Visible: |-
                =If(
                    IsBlank(dropdown_filterROOM.Selected.Value),
                    true,
                    false
                )
            Width: =Parent.Width + 6
            X: =-3
            Y: =- 5
            ZIndex: =14

    TextCanvas2 As Text:
        AutoHeight: =false
        BorderColor: =
        DisplayMode: =DisplayMode.Edit
        Fill: =
        FontColor: =
        Height: =dropdown_filterROOM.Height
        Size: =16
        Text: |-
            =With(
                {
                    // Raw control / variable inputs
                    selBldgRaw: dropdown_filterBLDG.Selected.Value,
                    selRoomRaw: dropdown_filterROOM.Selected.Value
                },
                With(
                    {
                        // Normalize: Blank() means "no specific filter"
                        selBldg:
                            If(
                                IsBlank(selBldgRaw) || selBldgRaw = "All",
                                Blank(),
                                selBldgRaw
                            ),
                        selRoom:
                            If(
                                IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                Blank(),
                                selRoomRaw
                            )
                    },
                    With(
                        {
                            // Apply building filter only if a building is really selected
                            buildingRows:
                                If(
                                    IsBlank(selBldg),
                                    col_CombiTable,
                                    Filter(
                                        col_CombiTable,
                                        Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                    )
                                )
                        },
                        With(
                            {
                                // Apply room filter only if a room is selected
                                roomRows:
                                    If(
                                        IsBlank(selRoom),
                                        buildingRows,
                                        Filter(
                                            buildingRows,
                                            Coalesce(Room_number, Room_number) = selRoom
                                        )
                                    )
                            },
                            With(
                                {
                                    // Count vacant blocks, excluding Out-Of-Service rows
                                    vacantBlocks:
                                        Sum(
                                            roomRows,
                                            If(
                                                Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                0,
                                                If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                            )
                                        )
                                },
                                // Final dynamic sentence (three cases)
                                If(
                                    IsBlank(selBldg),
                                    "There are currently " &
                                    Text(vacantBlocks) &
                                    " available blocks of time across all the Hines CBOC telehealth rooms.",
                                    
                                    If(
                                        IsBlank(selRoom),
                                        "There are currently " &
                                        Text(vacantBlocks) &
                                        " available blocks of time across all rooms of the " &
                                        selBldg &
                                        " CBOC.",
                                        
                                        "There are currently " &
                                        Text(vacantBlocks) &
                                        " available blocks of time in room #" &
                                        Text(selRoom) &
                                        " at the " &
                                        selBldg &
                                        " CBOC."
                                    )
                                )
                            )
                        )
                    )
                )
            )
        VerticalAlign: =VerticalAlign.Middle
        Visible: =false
        Weight: ='TextCanvas.Weight'.Bold
        Width: =icon_Reload.X - Self.X
        Wrap: =true
        X: =dropdown_filterROOM.X + dropdown_filterROOM.Width + 10
        Y: =dropdown_filterROOM.Y
        ZIndex: =12

    Container1 As groupContainer.manualLayoutContainer:
        Height: =Schedule_Screen.Height
        Visible: |-
            =If(
                IsBlank(varSchedScreenInstructions_visible) || varSchedScreenInstructions_visible = true,
                true,
                false
            )
        Width: =Schedule_Screen.Width
        Y: =
        ZIndex: =13

        Rectangle4 As rectangle:
            Fill: =RGBA(214, 221, 224, 0.74)
            Height: =Parent.Height
            Width: =Parent.Width
            ZIndex: =1

        Container4 As groupContainer.manualLayoutContainer:
            BorderColor: =RGBA(15, 84, 140, 1)
            BorderThickness: =5
            Fill: =RGBA(180, 214, 250, 1)
            Height: =287
            RadiusBottomLeft: =25
            RadiusBottomRight: =25
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Visible: =Rectangle4.Visible
            Width: =554
            X: =(Parent.Width / 2) - (Self.Width / 2)
            Y: =(Parent.Height / 2) - (Self.Height / 2)
            ZIndex: =2

            TextCanvas6 As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                Fill: =
                FontColor: =
                Height: =204
                Size: =28
                Text: ="Pick your preferred 'CBOC Location' and 'Room Number' using the filters above, then click on the specific day & timeslot to SELECT that block of time to begin your reservation request."
                VerticalAlign: =VerticalAlign.Top
                Weight: ='TextCanvas.Weight'.Bold
                Width: =Parent.Width - 10
                Wrap: =true
                X: =(Parent.Width / 2) - (Self.Width / 2)
                Y: =10
                ZIndex: =1

            Button7 As button:
                Height: =51
                OnSelect: |-
                    =If(
                        IsBlank(varSchedScreenInstructions_visible) || varSchedScreenInstructions_visible = true,
                        Set(varSchedScreenInstructions_visible, false)
                    );
                Size: =24
                Text: ="OK"
                Width: =150
                X: =(Parent.Width / 2) - (Self.Width / 2)
                Y: =TextCanvas6.Y + TextCanvas6.Height
                ZIndex: =2

    btnRefresh As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =5
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =FontWeight.Semibold
        Height: =btnUser.Height
        HoverBorderColor: =Color.DarkBlue
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =RGBA(255, 255, 255, 0.73)
        OnSelect: =Select(icon_Reload)
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Size: =24
        Text: =
        Width: =btnUser.Width
        X: =btnHome.X - Self.Width
        Y: =icon_Reload.Y
        ZIndex: =14

    btnHome As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =5
        Fill: =RGBA(0, 0, 0, 0)
        Height: =btnUser.Height
        HoverBorderColor: =Color.DarkBlue
        HoverFill: =RGBA(255, 255, 255, 0.73)
        OnSelect: =Select(icon_Home)
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Size: =24
        Text: =
        Width: =btnUser.Width
        X: =btnUser.X - Self.Width - 2
        Y: =btnUser.Y
        ZIndex: =15

    btnUser As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =5
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =FontWeight.Semibold
        Height: =icon_Home.Height + 2
        HoverBorderColor: =Color.DarkBlue
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =RGBA(255, 255, 255, 0.73)
        OnSelect: =Select(img_userAccount)
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Size: =24
        Text: =
        Width: =icon_Home.Width + 2
        X: =Parent.Width - Self.Width - 2
        Y: =2
        ZIndex: =16

    Container5 As groupContainer.manualLayoutContainer:
        Height: =container_Schedule_Single.Y   // lbl_filterROOM.Height + lbl_filterROOM.Y + dropdown_filterROOM.Height
        Width: =icon_Reload.X - Self.X - 5
        X: =dropdown_filterROOM.X + dropdown_filterROOM.Width + 10
        ZIndex: =17

        TextCanvas3 As Text:
            BorderColor: =
            DisplayMode: =DisplayMode.Edit
            Fill: =
            FontColor: =
            Height: =32
            Visible: =false
            Width: =96
            X: =40
            Y: =40
            ZIndex: =1

        HtmlText3 As htmlViewer:
            AutoHeight: =true
            Height: =Parent.Height
            HtmlText: |-
                =With(
                    {
                        // Raw control / variable inputs
                        selBldgRaw: dropdown_filterBLDG.Selected.Value,
                        selRoomRaw: dropdown_filterROOM.Selected.Value
                    },
                    With(
                        {
                            // Normalize selections (Blank() = no filter)
                            selBldg:
                                If(
                                    IsBlank(selBldgRaw) || selBldgRaw = "All",
                                    Blank(),
                                    selBldgRaw
                                ),
                            selRoom:
                                If(
                                    IsBlank(selRoomRaw) || Text(selRoomRaw) = "",
                                    Blank(),
                                    selRoomRaw
                                )
                        },
                        With(
                            {
                                buildingRows:
                                    If(
                                        IsBlank(selBldg),
                                        col_CombiTable,
                                        Filter(
                                            col_CombiTable,
                                            Coalesce(CBOC_Name_text, CBOC_Name_text) = selBldg
                                        )
                                    )
                            },
                            With(
                                {
                                    roomRows:
                                        If(
                                            IsBlank(selRoom),
                                            buildingRows,
                                            Filter(
                                                buildingRows,
                                                Coalesce(Room_number, Room_number) = selRoom
                                            )
                                        )
                                },
                                With(
                                    {
                                        vacantBlocks:
                                            Sum(
                                                roomRows,
                                                If(
                                                    Lower( Trim( Coalesce(Modified_Type, "") ) ) = "out-of-service",
                                                    0,
                                                    If(IsBlank(Day_Monday_text)    || Day_Monday_text    = "", 1, 0) +
                                                    If(IsBlank(Day_Tuesday_text)   || Day_Tuesday_text   = "", 1, 0) +
                                                    If(IsBlank(Day_Wednesday_text) || Day_Wednesday_text = "", 1, 0) +
                                                    If(IsBlank(Day_Thursday_text)  || Day_Thursday_text  = "", 1, 0) +
                                                    If(IsBlank(Day_Friday_text)    || Day_Friday_text    = "", 1, 0)
                                                )
                                            )
                                    },
                                    With(
                                        {
                                            colorNumber: "#b80000",   // color for the numeric count
                                            colorEntity: "#004b87"    // color for building / room text
                                        },
                                        //   "<div style='justify-content:center; align-items:top; height:100%;'>" &
                                        If(
                                            IsBlank(selBldg),
                                            // CASE 1: No building selected (or "All")
                                            "<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                            Text(vacantBlocks) &
                                            "</u></span> available blocks of time across all <span style='font-weight:bold;color:" & colorEntity & ";'><u>Hines CBOC's</u></span> telehealth rooms.</p>",
                
                                            If(
                                                IsBlank(selRoom),
                                                // CASE 2: Building only
                                                "<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                                Text(vacantBlocks) &
                                                "</u></span> available blocks of time across the entire <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                                selBldg &
                                                " CBOC</u></span>.</p>",
                
                                                // CASE 3: Building + Room
                                                "<p>There are currently <span style='font-weight:bold;color:" & colorNumber & ";'><u>" &
                                                Text(vacantBlocks) &
                                                "</u></span> available blocks of time in room <u><span style='font-weight:bold;color:" & colorEntity & ";'>#" &
                                                Text(selRoom) &
                                                "</u></span> at the <span style='font-weight:bold;color:" & colorEntity & ";'><u>" &
                                                selBldg &
                                                " CBOC</u></span>.</p>"
                                            )
                                        ) &
                                        "</div>"
                                    )
                                )
                            )
                        )
                    )
                )
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Width: =Parent.Width
            Y: =lbl_filterBLDG.Y
            ZIndex: =2

